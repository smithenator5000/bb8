<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>spheropy.Sphero API documentation</title>
    <meta name="description" content="Tools for controlling a Sphero 2.0. Sphero is the main class, all others define
parameter or return ..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#spheropy.Sphero.BluetoothInfo">BluetoothInfo</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#spheropy.Sphero.CollisionMsg">CollisionMsg</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#spheropy.Sphero.Color">Color</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#spheropy.Sphero.MotorState">MotorState</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#spheropy.Sphero.MotorValue">MotorValue</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#spheropy.Sphero.PacketTime">PacketTime</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#spheropy.Sphero.PowerState">PowerState</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#spheropy.Sphero.Response">Response</a></span>
        
        </li>
        <li class="mono">
        <span class="class_name"><a href="#spheropy.Sphero.Sphero">Sphero</a></span>
        
          
  <ul>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.__init__">__init__</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.L1_diag">L1_diag</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.L2_diag">L2_diag</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.assign_time">assign_time</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.boost">boost</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.connect">connect</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.disconnect">disconnect</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.find_spheros">find_spheros</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.get_bluetooth_info">get_bluetooth_info</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.get_chassis_id">get_chassis_id</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.get_color">get_color</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.get_permanent_options">get_permanent_options</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.get_power_state">get_power_state</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.get_versioning">get_versioning</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.get_voltage_trip_points">get_voltage_trip_points</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.ping">ping</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.poll_packet_times">poll_packet_times</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.register_collision_callback">register_collision_callback</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.register_power_callback">register_power_callback</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.register_sensor_callback">register_sensor_callback</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.roll">roll</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_back_light">set_back_light</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_color">set_color</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_data_stream">set_data_stream</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_device_name">set_device_name</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_heading">set_heading</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_inactivity_timeout">set_inactivity_timeout</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_motion_timeout">set_motion_timeout</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_permanent_options">set_permanent_options</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_power_notification">set_power_notification</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_raw_motor_values">set_raw_motor_values</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_rotation_rate">set_rotation_rate</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_stabilization">set_stabilization</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_stop_on_disconnect">set_stop_on_disconnect</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.set_voltage_trip_points">set_voltage_trip_points</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.sleep">sleep</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.start">start</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.start_collision_detection">start_collision_detection</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.stop">stop</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.stop_collision_detection">stop_collision_detection</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.stop_data_stream">stop_data_stream</a></li>
    <li class="mono"><a href="#spheropy.Sphero.Sphero.will_stop_on_disconnect">will_stop_on_disconnect</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">spheropy.Sphero</span> module</h1>
  <p>Tools for controlling a Sphero 2.0. Sphero is the main class, all others define
parameter or return classes.</p>
<p>Most sphero commands return a Response object, that has two data fields. 
<code>response.success</code> indicates if the operation was successful, and
<code>response.data</code> is any returned data, when appropriate.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Tools for controlling a Sphero 2.0. Sphero is the main class, all others define</span>
<span class="sd">parameter or return classes.</span>

<span class="sd">Most sphero commands return a Response object, that has two data fields. </span>
<span class="sd">`response.success` indicates if the operation was successful, and</span>
<span class="sd">`response.data` is any returned data, when appropriate.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">spheropy.BluetoothWrapper</span> <span class="kn">import</span> <span class="n">BluetoothWrapper</span>
<span class="kn">from</span> <span class="nn">spheropy.DataStream</span> <span class="kn">import</span> <span class="n">DataStreamManager</span>
<span class="kn">from</span> <span class="nn">spheropy.Exception</span> <span class="kn">import</span> <span class="n">SpheroException</span>
<span class="kn">from</span> <span class="nn">spheropy.Options</span> <span class="kn">import</span> <span class="n">PermanentOptions</span>
<span class="kn">from</span> <span class="nn">spheropy.Util</span> <span class="kn">import</span> <span class="n">nothing</span><span class="p">,</span> <span class="n">outside_range</span><span class="p">,</span> <span class="n">int_to_bytes</span><span class="p">,</span> <span class="n">check_sum</span><span class="p">,</span> <span class="n">eprint</span>

<span class="n">_MSRP</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># taken from sphero api docs</span>
    <span class="mh">0x00</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span><span class="p">,</span>  <span class="c1"># succeeded</span>
    <span class="mh">0x01</span><span class="p">:</span> <span class="s2">&quot;Error&quot;</span><span class="p">,</span>  <span class="c1"># non-specific error</span>
    <span class="mh">0x02</span><span class="p">:</span> <span class="s2">&quot;Checksum Error&quot;</span><span class="p">,</span>  <span class="c1"># chucksum failure</span>
    <span class="mh">0x03</span><span class="p">:</span> <span class="s2">&quot;Fragmented Command&quot;</span><span class="p">,</span>  <span class="c1"># FRAG command</span>
    <span class="mh">0x04</span><span class="p">:</span> <span class="s2">&quot;Unknown Command&quot;</span><span class="p">,</span>  <span class="c1"># unknown command id</span>
    <span class="mh">0x05</span><span class="p">:</span> <span class="s2">&quot;Command unsupported&quot;</span><span class="p">,</span>
    <span class="mh">0x06</span><span class="p">:</span> <span class="s2">&quot;Bad Message Format&quot;</span><span class="p">,</span>
    <span class="mh">0x07</span><span class="p">:</span> <span class="s2">&quot;Invalid Paramter values&quot;</span><span class="p">,</span>
    <span class="mh">0x08</span><span class="p">:</span> <span class="s2">&quot;Failed to execute command&quot;</span><span class="p">,</span>
    <span class="mh">0x09</span><span class="p">:</span> <span class="s2">&quot;Unknown Device Id&quot;</span><span class="p">,</span>
    <span class="mh">0x0A</span><span class="p">:</span> <span class="s2">&quot;Ram access need, but is busy&quot;</span><span class="p">,</span>
    <span class="mh">0x0B</span><span class="p">:</span> <span class="s2">&quot;Incorrect Password&quot;</span><span class="p">,</span>
    <span class="mh">0x31</span><span class="p">:</span> <span class="s2">&quot;Voltage too low for reflash&quot;</span><span class="p">,</span>
    <span class="mh">0x32</span><span class="p">:</span> <span class="s2">&quot;Illegal page number&quot;</span><span class="p">,</span>
    <span class="mh">0x33</span><span class="p">:</span> <span class="s2">&quot;Flash Fail: page did not reprogram correctly&quot;</span><span class="p">,</span>
    <span class="mh">0x34</span><span class="p">:</span> <span class="s2">&quot;Main application corruptted&quot;</span><span class="p">,</span>
    <span class="mh">0x35</span><span class="p">:</span> <span class="s2">&quot;Msg state machine timed out&quot;</span>
<span class="p">}</span>


<span class="n">_SOP1</span> <span class="o">=</span> <span class="mh">0xff</span>
<span class="n">_ANSWER</span> <span class="o">=</span> <span class="mh">0xff</span>
<span class="n">_NO_ANSWER</span> <span class="o">=</span> <span class="mh">0xfe</span>
<span class="n">_ACKNOWLEDGMENT</span> <span class="o">=</span> <span class="mh">0xff</span>
<span class="n">_ASYNC</span> <span class="o">=</span> <span class="mh">0xfe</span>

<span class="n">_CORE</span> <span class="o">=</span> <span class="mh">0x00</span>
<span class="n">_CORE_COMMANDS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;PING&#39;</span><span class="p">:</span> <span class="mh">0x01</span><span class="p">,</span>
    <span class="s1">&#39;GET VERSIONING&#39;</span><span class="p">:</span> <span class="mh">0x02</span><span class="p">,</span>
    <span class="s1">&#39;SET NAME&#39;</span><span class="p">:</span> <span class="mh">0x10</span><span class="p">,</span>
    <span class="s1">&#39;GET BLUETOOTH INFO&#39;</span><span class="p">:</span> <span class="mh">0x11</span><span class="p">,</span>
    <span class="s1">&#39;GET POWER STATE&#39;</span><span class="p">:</span> <span class="mh">0x20</span><span class="p">,</span>
    <span class="s1">&#39;SET POWER NOTIFICATION&#39;</span><span class="p">:</span> <span class="mh">0x21</span><span class="p">,</span>
    <span class="s1">&#39;SLEEP&#39;</span><span class="p">:</span> <span class="mh">0x22</span><span class="p">,</span>
    <span class="s1">&#39;GET VOLTAGE TRIP&#39;</span><span class="p">:</span> <span class="mh">0x23</span><span class="p">,</span>
    <span class="s1">&#39;SET VOLTAGE TRIP&#39;</span><span class="p">:</span> <span class="mh">0x24</span><span class="p">,</span>
    <span class="s1">&#39;SET INACT TIMEOUT&#39;</span><span class="p">:</span> <span class="mh">0x25</span><span class="p">,</span>
    <span class="s1">&#39;L1&#39;</span><span class="p">:</span> <span class="mh">0x40</span><span class="p">,</span>
    <span class="s1">&#39;L2&#39;</span><span class="p">:</span> <span class="mh">0x41</span><span class="p">,</span>
    <span class="s1">&#39;ASSIGN TIME&#39;</span><span class="p">:</span> <span class="mh">0x50</span><span class="p">,</span>
    <span class="s1">&#39;POLL PACKET TIMES&#39;</span><span class="p">:</span> <span class="mh">0x51</span>

<span class="p">}</span>

<span class="n">_SPHERO</span> <span class="o">=</span> <span class="mh">0x02</span>
<span class="n">_SPHERO_COMMANDS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;SET HEADING&#39;</span><span class="p">:</span> <span class="mh">0x01</span><span class="p">,</span>
    <span class="s1">&#39;SET STABILIZATION&#39;</span><span class="p">:</span> <span class="mh">0x02</span><span class="p">,</span>
    <span class="s1">&#39;SET ROTATION RATE&#39;</span><span class="p">:</span> <span class="mh">0x03</span><span class="p">,</span>
    <span class="s1">&#39;GET CHASSIS ID&#39;</span><span class="p">:</span> <span class="mh">0x07</span><span class="p">,</span>
    <span class="s1">&#39;SET DATA STRM&#39;</span><span class="p">:</span> <span class="mh">0x11</span><span class="p">,</span>
    <span class="s1">&#39;SET COLLISION DETECT&#39;</span><span class="p">:</span> <span class="mh">0x12</span><span class="p">,</span>
    <span class="s1">&#39;SET COLOR&#39;</span><span class="p">:</span> <span class="mh">0x20</span><span class="p">,</span>
    <span class="s1">&#39;SET BACKLIGHT&#39;</span><span class="p">:</span> <span class="mh">0x21</span><span class="p">,</span>
    <span class="s1">&#39;GET COLOR&#39;</span><span class="p">:</span> <span class="mh">0x22</span><span class="p">,</span>
    <span class="s1">&#39;ROLL&#39;</span><span class="p">:</span> <span class="mh">0x30</span><span class="p">,</span>
    <span class="s1">&#39;BOOST&#39;</span><span class="p">:</span> <span class="mh">0x31</span><span class="p">,</span>
    <span class="s1">&#39;SET RAW MOTOR&#39;</span><span class="p">:</span> <span class="mh">0x33</span><span class="p">,</span>
    <span class="s1">&#39;MOTION TIMEOUT&#39;</span><span class="p">:</span> <span class="mh">0x34</span><span class="p">,</span>
    <span class="s1">&#39;SET PERM OPTIONS&#39;</span><span class="p">:</span> <span class="mh">0x35</span><span class="p">,</span>
    <span class="s1">&#39;GET PERM OPTIONS&#39;</span><span class="p">:</span> <span class="mh">0x36</span><span class="p">,</span>
    <span class="s1">&#39;SET TEMP OPTIONS&#39;</span><span class="p">:</span> <span class="mh">0x37</span><span class="p">,</span>
    <span class="s1">&#39;GET TEMP OPTIONS&#39;</span><span class="p">:</span> <span class="mh">0x38</span><span class="p">,</span>

<span class="p">}</span>

<span class="n">BluetoothInfo</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;BluetoothInfo&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;address&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">])</span>
<span class="n">Color</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Color&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">MotorValue</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;MotorValue&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span> <span class="s1">&#39;power&#39;</span><span class="p">])</span>
<span class="n">PacketTime</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;PacketTime&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">])</span>
<span class="n">PowerState</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;PowerState&#39;</span><span class="p">,</span> <span class="p">[</span>
                        <span class="s1">&#39;recVer&#39;</span><span class="p">,</span> <span class="s1">&#39;power_state&#39;</span><span class="p">,</span> <span class="s1">&#39;batt_voltage&#39;</span><span class="p">,</span> <span class="s1">&#39;num_charges&#39;</span><span class="p">,</span> <span class="s1">&#39;time_since_chg&#39;</span><span class="p">])</span>
<span class="n">Response</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Response&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">CollisionMsg</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;CollisionMsg&#39;</span><span class="p">,</span> <span class="p">[</span>
                          <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="s1">&#39;x_magnitude&#39;</span><span class="p">,</span> <span class="s1">&#39;y_magnitude&#39;</span><span class="p">,</span> <span class="s1">&#39;speed&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">MotorState</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An enum to represent possible motor states</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">off</span> <span class="o">=</span> <span class="mh">0x00</span>
    <span class="n">forward</span> <span class="o">=</span> <span class="mh">0x01</span>
    <span class="n">reverse</span> <span class="o">=</span> <span class="mh">0x02</span>
    <span class="n">brake</span> <span class="o">=</span> <span class="mh">0x03</span>
    <span class="n">ignore</span> <span class="o">=</span> <span class="mh">0x04</span>


<span class="k">class</span> <span class="nc">Sphero</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class representing a sphero. Can be used in a `with` block or managed explicitly.</span>

<span class="sd">    All direct sphero commands will return a `Response` object. where `response.success`</span>
<span class="sd">    indicates if the command ran successfully, and `response.data` will contain the</span>
<span class="sd">    data of the response or what went wrong. Other returns will be specified</span>

<span class="sd">    ### Usage:</span>

<span class="sd">        #!python</span>
<span class="sd">        from spheropy.Sphero import Sphero</span>
<span class="sd">        # explicit managment</span>
<span class="sd">        s = Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;)</span>
<span class="sd">        s.connect()</span>
<span class="sd">        s.start() # starts receiving data from sphero</span>
<span class="sd">        s.roll(50, 0)</span>
<span class="sd">        s.exit()</span>

<span class="sd">        # context manager</span>
<span class="sd">        with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">            s.roll(50, 0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># Static Methods</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">find_spheros</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary from names to addresses of all available spheros</span>
<span class="sd">        `tries` indicates the number of scans to perform before returning results.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            found_spheros = Sphero.find_spheros()</span>
<span class="sd">            for key, value in found_sphero.iteritems():</span>
<span class="sd">                print(&quot;Name: {}\tAddress: {}&quot;.format(key, value))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">BluetoothWrapper</span><span class="o">.</span><span class="n">find_free_devices</span><span class="p">(</span><span class="n">tries</span><span class="o">=</span><span class="n">tries</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="s2">&quot;[Ss]phero&quot;</span><span class="p">)</span>


<span class="c1"># Working</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">response_time_out</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">number_tries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `name` is mostly used in printing error and information messages, usefull when working with</span>
<span class="sd">        more then one sphero.</span>

<span class="sd">        `address` is the bluetooth address and `port` is the RFCOMM port to use every sphero I&#39;ve used</span>
<span class="sd">        uses port 1 so you unless you have trouble connectng it shouldn&#39;t need to change.</span>

<span class="sd">        `response_time_out` indicates how long to wait in seconds for a response after a message</span>
<span class="sd">        that expects a response is sent ,it does not include sendng time.</span>

<span class="sd">        Any command will be sent up to `number_tries` untill it is successful. This only happens</span>
<span class="sd">        if a response is expected, otherwise it&#39;s sent once.  A single command</span>
<span class="sd">        with a response may block for up to `response_time_out` X `number_tries` seconds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Sphero</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span> <span class="o">=</span> <span class="n">BluetoothWrapper</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot; access to bluetooth wrapper, avoid using &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suppress_exception</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="sd">&quot;&quot;&quot; suppress_exceptions when used in `with` block &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_seq_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_tries</span> <span class="o">=</span> <span class="n">number_tries</span>
        <span class="sd">&quot;&quot;&quot; number of times to try to send a command to sphero &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_msg_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_SOP1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_time_out</span> <span class="o">=</span> <span class="n">response_time_out</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_recieve_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_recieve_loop</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_asyn_func</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mh">0x01</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_power_notification</span><span class="p">,</span>
            <span class="mh">0x02</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward_L1_diag</span><span class="p">,</span>
            <span class="mh">0x03</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sensor_data</span><span class="p">,</span>
            <span class="mh">0x07</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collision_detect</span><span class="p">,</span>
            <span class="c1"># 0x0B: self._self_level_result,</span>
            <span class="c1"># 0x0C: self._gyro_exceeded</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_sensor_callback</span> <span class="o">=</span> <span class="n">nothing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_power_callback</span> <span class="o">=</span> <span class="n">nothing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collision_callback</span> <span class="o">=</span> <span class="n">nothing</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; for use in contex manager &quot;&quot;&quot;</span>
        <span class="n">connected</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">tries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">connected</span> <span class="ow">and</span> <span class="n">tries</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_tries</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">suppress_exceptions</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">SpheroException</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">tries</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_tries</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SpheroException</span><span class="p">(</span><span class="s2">&quot;Unable to connect to sphero&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; for use in context manager &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppress_exception</span>

    <span class="k">def</span> <span class="nf">_recieve_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; recieves data from sphero and parses it&quot;&quot;&quot;</span>
        <span class="n">packet</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">is_connected</span><span class="p">():</span>
            <span class="c1"># state one</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">packet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="n">packet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">_SOP1</span><span class="p">:</span>
                    <span class="n">packet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                <span class="c1"># state two</span>
                <span class="n">packet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">packet_type</span> <span class="o">=</span> <span class="n">packet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">packet_type</span> <span class="o">==</span> <span class="n">_ACKNOWLEDGMENT</span><span class="p">:</span>  <span class="c1"># Sync Packet</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_handle_acknowledge</span><span class="p">()</span>

                <span class="k">elif</span> <span class="n">packet_type</span> <span class="o">==</span> <span class="n">_ASYNC</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_handle_async</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">eprint</span><span class="p">(</span><span class="s2">&quot;Malformed Packet&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">SpheroException</span><span class="p">:</span>
                <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_handle_acknowledge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses response packets from sphero. Response added to a response dictionary</span>
<span class="sd">        as a Response tuple where tuple[0] indicates success and tuple[1] is the data,</span>
<span class="sd">        the thread waiting on the response is alerted to it via an event registered</span>
<span class="sd">        in the response_event_lookup dictionary, and is responsible for parsing the data.</span>
<span class="sd">        all access should be done with the response_lock.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msrp</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mh">0xff</span><span class="p">:</span>
            <span class="k">pass</span>
            <span class="c1"># raise Exception(&quot;NOt Implemented _MSRP: {0}&quot;.format(_msrp))</span>
            <span class="c1"># TODO cover oxff cases</span>
        <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">msrp</span>
        <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span>
        <span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">length</span>
        <span class="n">checksum</span> <span class="o">=</span> <span class="n">check_sum</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">checksum</span><span class="p">:</span>
            <span class="n">eprint</span><span class="p">(</span><span class="s2">&quot;Malfromed Packet, recieved: {0} expected: {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">checksum</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">:</span>
                    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="n">seq</span><span class="p">]</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="n">seq</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span>
            <span class="k">if</span> <span class="n">msrp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="p">[</span><span class="n">seq</span><span class="p">]</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span> <span class="n">length</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="p">[</span><span class="n">seq</span><span class="p">]</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span>
                    <span class="bp">False</span><span class="p">,</span> <span class="n">_MSRP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">msrp</span><span class="p">,</span> <span class="s2">&quot;UNKNOWN ERROR&quot;</span><span class="p">))</span>
            <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_handle_async</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles async (usually sensor) messages form sphero,</span>
<span class="sd">        It calls the a parser function which will call any regstered</span>
<span class="sd">        callback for each type of data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">id_code</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">length_msb</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">length_lsb</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">length</span> <span class="o">=</span> <span class="p">(</span><span class="n">length_msb</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">length_lsb</span>

        <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_code</span>
        <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">length_msb</span>
        <span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">length_lsb</span>
        <span class="n">checksum</span> <span class="o">=</span> <span class="n">check_sum</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">checksum</span><span class="p">:</span>
            <span class="n">eprint</span><span class="p">(</span><span class="s2">&quot;Malfromed Packet, recieved: {0} expected: {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">checksum</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">tocall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_asyn_func</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">id_code</span><span class="p">,</span> <span class="n">nothing</span><span class="p">)</span>
            <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">tocall</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="p">,))</span>
            <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        reads a given length from the bluetooth, into a buffer, starting at a given offset</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">array</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">to_read</span> <span class="o">=</span> <span class="n">length</span>
        <span class="k">while</span> <span class="n">to_read</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">to_read</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">+=</span> <span class="n">out</span>
            <span class="n">to_read</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">array</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        used for assigning unique seq numbers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_seq_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_num</span> <span class="o">&gt;</span> <span class="mh">0xff</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_num</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_num</span>

    <span class="k">def</span> <span class="nf">_send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">did</span><span class="p">,</span> <span class="n">cid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sends data to sphero `did` is the device id, `cid` is the virtual core id</span>
<span class="sd">        for more information view sphero Docs.</span>

<span class="sd">        `data` is the data to send</span>

<span class="sd">        `response` indicates if a response is expected or not if it is it handles</span>
<span class="sd">        working with the event system, and blocks until response is recieved,</span>
<span class="sd">        or `self.response_time_out` elapses</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">seq_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
                <span class="n">seq_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq</span>
                <span class="n">event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="n">seq_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">event</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ANSWER</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="n">_NO_ANSWER</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">did</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">cid</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq_number</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_length</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">6</span> <span class="o">+</span> <span class="n">data_length</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">checksum</span> <span class="o">=</span> <span class="n">check_sum</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span> <span class="mi">6</span> <span class="o">+</span> <span class="n">data_length</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">6</span> <span class="o">+</span> <span class="n">data_length</span><span class="p">]</span> <span class="o">=</span> <span class="n">checksum</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
                <span class="nb">buffer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="mi">6</span> <span class="o">+</span> <span class="n">data_length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_response_time_out</span><span class="p">):</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="p">[</span><span class="n">seq_number</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Establishes a connection and</span>
<span class="sd">        returns a boolean indicating if the connection was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closes the connection to the sphero.</span>
<span class="sd">        If sphero is not connected the call has no effect.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_stable_send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">did</span><span class="p">,</span> <span class="n">cid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A version of send that tries untill successful</span>
<span class="sd">        if response is false it will only try once</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">success</span> <span class="ow">and</span> <span class="n">tries</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_tries</span><span class="p">:</span>
            <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="n">did</span><span class="p">,</span> <span class="n">cid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
            <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">success</span> <span class="o">=</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span>
        <span class="k">return</span> <span class="n">reply</span>
<span class="c1"># CORE COMMANDS</span>

    <span class="k">def</span> <span class="nf">ping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Ping command is used to verify both a solid data link with the caller</span>
<span class="sd">        and that Sphero is awake and dispatching commands.</span>

<span class="sd">        A Response tuple is returned with response.success indicating if a response</span>
<span class="sd">        is received back from the sphero, there is no accompanying data.</span>

<span class="sd">        # Usage</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                response = s.ping()</span>
<span class="sd">                print(response.success)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;PING&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">get_versioning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A Response tuple is returned, if `response.success == True`, then</span>
<span class="sd">        `response.data` will contain a tuple of the bytes of the versioning info.</span>

<span class="sd">        see Sphero api docs for more info.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET VERSIONING&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s2">&quot;&gt;8B&quot;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">parsed</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">set_device_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This assigned name is held internally and produced as part of the Get Bluetooth Info</span>
<span class="sd">        service below. Names are clipped at 48 characters in length to support UTF - 8 sequences</span>
<span class="sd">        you can send something longer but the extra will be discarded.</span>
<span class="sd">        This field defaults to the Bluetooth advertising name.</span>

<span class="sd">        The returned Response objects data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET NAME&#39;</span><span class="p">],</span> <span class="n">name</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_bluetooth_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If successful the returned Response Object&#39;s data field</span>
<span class="sd">        is a BluetoothInfo object containing the textual</span>
<span class="sd">        name of the ball (defaults to the Bluetooth</span>
<span class="sd">        advertising name but can be changed), the Bluetooth address and</span>
<span class="sd">        the ID colors the ball blinks when not connected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET BLUETOOTH INFO&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;&gt;16s12sx3c&quot;</span>
            <span class="n">temp_tup</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)]</span>
            <span class="n">named_tuple</span> <span class="o">=</span> <span class="n">BluetoothInfo</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">temp_tup</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">named_tuple</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">get_power_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If successful the response.data will contains a</span>
<span class="sd">        PowerState tuple with the following fields in this order.</span>

<span class="sd">            `recVer`: set to 1</span>

<span class="sd">            `powerState`: 1 = Charging, 2 = OK, 3 = Low, 4 = Critical</span>

<span class="sd">            `batt_voltage`: current battery voltage in 100ths of a volt</span>

<span class="sd">            `num_charges`: number of recharges in the lilfe of this sphero</span>

<span class="sd">            `time_since_chg`: seconds Awake</span>
<span class="sd">        `</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                response = s.get_power_state()</span>
<span class="sd">                if response.success:</span>
<span class="sd">                    power = response.data</span>
<span class="sd">                    print(&quot;power_state: {}&quot;.format(power.power_state))</span>
<span class="sd">                    print(&quot;Voltage: {}&quot;.format(power.batt_voltage))</span>
<span class="sd">                    print(&quot;Number Charges: {}&quot;.format(power.num_charges))</span>
<span class="sd">                    print(&quot;Time Since Charge: {}&quot;.format(power.time_since_chg))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET POWER STATE&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">parsed_answer</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;BBHHH&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">PowerState</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">parsed_answer</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">set_power_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setting</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets Async power notification messages to be sent. To access the notifications register a power_notfiation callback. Notifications</span>
<span class="sd">        are sent every 10 seconds</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="k">if</span> <span class="n">setting</span> <span class="k">else</span> <span class="mh">0x00</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET POWER NOTIFICATION&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">flag</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">sleep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wakeup_time</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This command puts Sphero to sleep immediately.</span>
<span class="sd">        The sphero will automaticall reawaken after `wakeup_time` seconds.</span>
<span class="sd">        Zero does not program a wakeup interval, so it sleeps forever.</span>

<span class="sd">        The Sphero must be reconnected after this function is called. However,</span>
<span class="sd">        most settings are preserved.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">wakeup_time</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">wakeup_time</span> <span class="o">&gt;</span> <span class="mh">0xffff</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">big</span> <span class="o">=</span> <span class="n">wakeup_time</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
        <span class="n">little</span> <span class="o">=</span> <span class="p">(</span><span class="n">wakeup_time</span> <span class="o">&amp;</span> <span class="mh">0x00ff</span><span class="p">)</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SLEEP&#39;</span><span class="p">],</span> <span class="p">[</span>
            <span class="n">big</span><span class="p">,</span> <span class="n">little</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">get_voltage_trip_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If successful the Response Object&#39;s data field contains a tuple of the</span>
<span class="sd">        voltage trip points for what Sphero considers Low and Critical battery.</span>
<span class="sd">        The values are expressed in 100ths of a volt,</span>
<span class="sd">        so the defaults of 7.00V and 6.50V respectively are returned as</span>
<span class="sd">        700 and 650.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET VOLTAGE TRIP&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">parse</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s2">&quot;&gt;HH&quot;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">parse</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">set_voltage_trip_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">critical</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DOES NOT WORK</span>
<span class="sd">        not implemented</span>
<span class="sd">        This assigns the voltage trip points for Low and Critical battery voltages.</span>
<span class="sd">        The values are specified in 100ths of a volt and</span>
<span class="sd">        the limitations on adjusting these away from their defaults are:</span>
<span class="sd">        Vlow must be in the range 675 to 725 ( += 25)</span>
<span class="sd">        Vcrit must be in the range 625 to 675 ( += 25)</span>
<span class="sd">        There must be 0.25V of separation between the two values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">False</span>
        <span class="n">low</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">crit</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">critical</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET VOLTAGE TRIP&#39;</span><span class="p">],</span> <span class="n">low</span> <span class="o">+</span> <span class="n">crit</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_inactivity_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets inactivity time out. Value must be greater than 60 seconds,</span>
<span class="sd">        is preserved across power cycles.</span>

<span class="sd">       The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">timeout</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">timeout</span> <span class="o">&gt;</span> <span class="mh">0xffff</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="n">big</span> <span class="o">=</span> <span class="n">timeout</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
        <span class="n">little</span> <span class="o">=</span> <span class="p">(</span><span class="n">timeout</span> <span class="o">&amp;</span> <span class="mh">0x00ff</span><span class="p">)</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET INACT TIMEOUT&#39;</span><span class="p">],</span> <span class="p">[</span>
            <span class="n">big</span><span class="p">,</span> <span class="n">little</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">L1_diag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a developer - level command to help diagnose aberrant behavior.</span>
<span class="sd">        Most system counters, process flags, and system states are decoded</span>
<span class="sd">        into human readable ASCII.</span>

<span class="sd">        If successful the Response Object&#39;s data field will contain an ASCII message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">event</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_response_time_out</span> <span class="o">*</span> <span class="mi">10</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;no data recieved&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">L2_diag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DOES NOT WORK</span>
<span class="sd">        This is a developers - only command to help diagnose aberrant behavior.</span>
<span class="sd">        It is much less informative than the Level 1 command</span>
<span class="sd">        but it is in binary format and easier to parse</span>
<span class="sd">        Command not found</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;L2&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">assign_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_value</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the internal timer to `time_value`. </span>
<span class="sd">        This is the time that shows up in a collision message.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;ASSIGN TIME&#39;</span><span class="p">],</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">time_value</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">poll_packet_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Command to help profile latencies</span>
<span class="sd">        returns a PacketTime tuple with fields:</span>
<span class="sd">        offset: the maximum - likelihood time offset of the Client clock to sphero&#39;s system clock</span>
<span class="sd">        delay: round - trip delay between client a sphero</span>

<span class="sd">        DOESN&quot;T REALLY WORK YET....</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO time 1 gets mangled.</span>
        <span class="n">time1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
        <span class="n">bit1</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0xff000000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span>
        <span class="n">bit2</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0x00ff0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
        <span class="n">bit3</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0x0000ff00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
        <span class="n">bit4</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0x000000ff</span><span class="p">)</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;POLL PACKET TIMES&#39;</span><span class="p">],</span> <span class="p">[</span>
            <span class="n">bit1</span><span class="p">,</span> <span class="n">bit2</span><span class="p">,</span> <span class="n">bit3</span><span class="p">,</span> <span class="n">bit4</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">time4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
        <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">sphero_time</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;III&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                <span class="p">((</span><span class="n">sphero_time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sphero_time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">sphero_time</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">time4</span><span class="p">))</span>
            <span class="n">delay</span> <span class="o">=</span> <span class="p">(</span><span class="n">time4</span> <span class="o">-</span> <span class="n">sphero_time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> \
                <span class="p">(</span><span class="n">sphero_time</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">sphero_time</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">PacketTime</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>

<span class="c1"># _SPHERO COMMANDS</span>

    <span class="k">def</span> <span class="nf">set_heading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">heading</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the spheros heading in degrees,</span>
<span class="sd">        heading must range between 0 to 359. This should move the</span>
<span class="sd">        back tail light.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">heading</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">heading</span> <span class="o">&gt;</span> <span class="mi">359</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;heading must be between 0 and 359&quot;</span><span class="p">)</span>

        <span class="n">heading_bytes</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">heading</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET HEADING&#39;</span><span class="p">],</span> <span class="n">heading_bytes</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">set_stabilization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stablize</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This turns on or off the internal stabilization of Sphero,</span>
<span class="sd">        the IMU is used to match the ball&#39;s orientation to its set points.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="k">if</span> <span class="n">stablize</span> <span class="k">else</span> <span class="mh">0x00</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET STABILIZATION&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">flag</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_rotation_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DOESN&#39;t WORK</span>
<span class="sd">        This sets the roation rate sphero will use to meet new heading commands</span>
<span class="sd">        Lower value offers better control, with a larger turning radius.</span>
<span class="sd">        The rate should be in degrees / sec,</span>
<span class="sd">        anythin above 199 the maxium value is used(400 degrees / sec)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO returns unknown command</span>
        <span class="k">if</span> <span class="n">rate</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;USE POSITIVE RATE ONLY&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rate</span> <span class="o">&gt;</span> <span class="mi">199</span><span class="p">:</span>
            <span class="n">rate</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rate</span> <span class="o">/</span> <span class="mf">0.784</span><span class="p">)</span>
        <span class="n">to_bytes</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET ROTATION RATE&#39;</span><span class="p">],</span> <span class="n">to_bytes</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_chassis_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the Chassis ID as an int.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET CHASSIS ID&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">tup</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;H&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span>

    <span class="k">def</span> <span class="nf">set_data_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream_settings</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">packet_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets data stream options, where `stream_settings` is a DataStreamManager object,</span>
<span class="sd">        and `frequency` how often you want to recieve data and `packet_count` indicates</span>
<span class="sd">        the number of packets you want to recieve, set to zero for unlimited streaming.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>
<span class="sd">            from spheropy.DataStream import DataStreamManager</span>

<span class="sd">            dsm = DataStreamManager()</span>
<span class="sd">            dsm.acc = True</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.set_data_stream(dsm, 10 packet_count=2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span> <span class="o">=</span> <span class="n">stream_settings</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">divisor</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">400.0</span> <span class="o">/</span> <span class="n">frequency</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span><span class="o">.</span><span class="n">number_frames</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mask1</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span><span class="o">.</span><span class="n">mask1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">mask2</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span><span class="o">.</span><span class="n">mask2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">divisor</span> <span class="o">+</span> <span class="n">samples</span> <span class="o">+</span> <span class="n">mask1</span> <span class="o">+</span> <span class="p">[</span><span class="n">packet_count</span><span class="p">]</span> <span class="o">+</span> <span class="n">mask2</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET DATA STRM&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop_data_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        stops data streaming</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET DATA STRM&#39;</span><span class="p">],</span> <span class="p">[</span>
                                   <span class="mh">0xff</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">start_collision_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_threshold</span><span class="p">,</span> <span class="n">x_speed</span><span class="p">,</span> <span class="n">y_threshold</span><span class="p">,</span> <span class="n">y_speed</span><span class="p">,</span> <span class="n">dead</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts collision detection. `Threshold` values represent the max threshold,</span>
<span class="sd">        and `speed` is added to the thresholds to rang detection by the spheros speed,</span>
<span class="sd">        `dead` is the minimum time between detections</span>
<span class="sd">        in ms. all data must be in the range 0...255</span>

<span class="sd">        For more infomation see Collision Detection pdf</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">method</span> <span class="o">=</span> <span class="mh">0x01</span>
        <span class="n">dead</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dead</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET COLLISION DETECT&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">method</span><span class="p">,</span> <span class="n">x_threshold</span><span class="p">,</span> <span class="n">x_speed</span><span class="p">,</span> <span class="n">y_threshold</span><span class="p">,</span> <span class="n">y_speed</span><span class="p">,</span> <span class="n">dead</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop_collision_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops collision detection</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET COLLISION DETECT&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the color of the sphero given rgb components between 0 and 255,</span>
<span class="sd">        if `default` is true, sphero will default to that color when first connected</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from time import sleep</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.set_color(255, 0, 0)</span>
<span class="sd">                sleep(1)</span>
<span class="sd">                s.set_color(0, 255, 0)</span>
<span class="sd">                sleep(1)</span>
<span class="sd">                s.set_color(0, 0, 255)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">red</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">red</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">blue</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">blue</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">green</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">green</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x01</span><span class="p">]</span> <span class="k">if</span> <span class="n">default</span> <span class="k">else</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET COLOR&#39;</span><span class="p">],</span> <span class="n">red</span> <span class="o">+</span> <span class="n">green</span> <span class="o">+</span> <span class="n">blue</span> <span class="o">+</span> <span class="n">flag</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_back_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brightness</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Controls the brightness of the back LED, non persistent</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">brightness</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">brightness</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET BACKLIGHT&#39;</span><span class="p">],</span> <span class="n">brightness</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If sucessful `response.data` contains the sphero default</span>
<span class="sd">        Color, may not be the current color shown.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                response = s.get_color()</span>
<span class="sd">                if response.success:</span>
<span class="sd">                    color = response.data</span>
<span class="sd">                    print(&quot;r: {}  b: {}  g: {}&quot;.format(color.r, color.b, color.g))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET COLOR&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">parse</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;BBB&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">Color</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">parse</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span>

    <span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">heading</span><span class="p">,</span> <span class="n">fast_rotate</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Commands the sphero to move. `speed` ranges from 0..255, while `heading` is</span>
<span class="sd">        in degrees from 0..359, 0 is strait, 90 is to the right, 180 is back and</span>
<span class="sd">        270 is to the left. When `fast_rotate` is set to True sphero will rotate as</span>
<span class="sd">        quickly as possible to given heading regardless of speed.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gobit</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x02</span><span class="p">]</span> <span class="k">if</span> <span class="n">fast_rotate</span> <span class="k">else</span> <span class="p">[</span><span class="mh">0x01</span><span class="p">]</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">heading</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">heading</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;ROLL&#39;</span><span class="p">],</span> <span class="n">speed</span> <span class="o">+</span> <span class="n">heading</span> <span class="o">+</span> <span class="n">gobit</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Commands the Shero to stop.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;ROLL&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">boost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">activate</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Activates or deactivates boost, depending on the truth value of `activate`.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">activate</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="k">if</span> <span class="n">activate</span> <span class="k">else</span> <span class="mh">0x00</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;BOOST&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">activate</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_raw_motor_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_value</span><span class="p">,</span> <span class="n">right_value</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows direct controle of the motors</span>
<span class="sd">        both motor values should be MotorValue tuple</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lmode</span> <span class="o">=</span> <span class="n">left_value</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
        <span class="n">lpower</span> <span class="o">=</span> <span class="n">left_value</span><span class="o">.</span><span class="n">power</span>
        <span class="n">rmode</span> <span class="o">=</span> <span class="n">right_value</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
        <span class="n">rpower</span> <span class="o">=</span> <span class="n">right_value</span><span class="o">.</span><span class="n">power</span>
        <span class="k">if</span> <span class="n">outside_range</span><span class="p">(</span><span class="n">lpower</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="ow">or</span> <span class="n">outside_range</span><span class="p">(</span><span class="n">rpower</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SpheroException</span><span class="p">(</span><span class="s2">&quot;Values outside of range&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">lmode</span><span class="p">,</span> <span class="n">lpower</span><span class="p">,</span> <span class="n">rmode</span><span class="p">,</span> <span class="n">rpower</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET RAW MOTOR&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_motion_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This sets the ultimate timeout for the last motion command</span>
<span class="sd">        to keep Sphero from rolling away</span>
<span class="sd">        timeout is in miliseconds and defaults to 2000</span>
<span class="sd">        for this to be in effect motion timeout must be</span>
<span class="sd">        in must be set in permanent options</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outside_range</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xFFFF</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SpheroException</span><span class="p">(</span><span class="s2">&quot;Timeout outside of valid range&quot;</span><span class="p">)</span>
        <span class="n">timeout</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;MOTION TIMEOUT&#39;</span><span class="p">],</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_permanent_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set Options, for option information see PermanentOptionFlag docs.</span>
<span class="sd">        Options persist across power cycles. `options` is a Permanent Option Object</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>
<span class="sd">            from spheropy.Options import PermanentOptions</span>

<span class="sd">            po = PermanentOptions()</span>
<span class="sd">            po.set_light_wakeup_sensitivity= True</span>
<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.set_permanent_options(po)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">bitflags</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET PERM OPTIONS&#39;</span><span class="p">],</span> <span class="n">options</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_permanent_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If successful `result.data` contains the Permenent Options of the sphero</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET PERM OPTIONS&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">settings</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;Q&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">PermanentOptions</span><span class="p">()</span>
            <span class="n">options</span><span class="o">.</span><span class="n">bitflags</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">set_stop_on_disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets sphero to stop on disconnect, this is a one_shot, so it must be reset on reconnect.</span>

<span class="sd">        Set `value` to false to turn off behavior.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET TEMP OPTIONS&#39;</span><span class="p">],</span> <span class="p">[</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">will_stop_on_disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns if the sphero will stop when it is disconnected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET TEMP OPTOINS&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>
<span class="c1"># ASYNC</span>

    <span class="k">def</span> <span class="nf">register_sensor_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a function to call when a sensor message is recieved.</span>
<span class="sd">        `func` must be callable and it will be started in its own thread</span>
<span class="sd">        as not to block the recieve loop.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from time import sleep</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            dsm = DataStreamManager()</span>
<span class="sd">            dsm.acc = True</span>
<span class="sd">            dsm.odom = True</span>

<span class="sd">            #assume acc and odom sensor messages have be requested</span>
<span class="sd">            def callback(sensor_data):</span>
<span class="sd">                #sensor_data will be an array of dictionaries where</span>
<span class="sd">                #each item is a frame sent by the sphero</span>
<span class="sd">                for  frames in sensor_data:</span>
<span class="sd">                    print(frames[&#39;acc&#39;])</span>
<span class="sd">                    print(frames[&#39;odom&#39;])</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.register_sensor_callback(callback)</span>
<span class="sd">                s.set_data_stream(dsm, 10 packet_count=2)</span>
<span class="sd">                # callback will be called twice</span>
<span class="sd">                sleep(1) # so data will be recieved before exit</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sensor_callback</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">register_power_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a function to call when an async power notification is recieved. `func` must be callable and it will be started in it&#39;s own thread. The call back will recieve an integer with:</span>

<span class="sd">        1 = charging</span>

<span class="sd">        2 = OK</span>

<span class="sd">        3 = Low</span>

<span class="sd">        4 = Critical </span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            import time</span>
<span class="sd">            from sphropy.Sphero import Sphero</span>

<span class="sd">            def callback(notification):</span>
<span class="sd">                print(notification)</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.register_power_callback(callback)</span>
<span class="sd">                s.set_power_notification(True)</span>
<span class="sd">                time.sleep(20)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_power_callback</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">register_collision_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers a callback function for asyn collision notifications.</span>
<span class="sd">        `func` must be callable and it is started in it&#39;s own thread</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            import time</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            def callback(data):</span>
<span class="sd">                #data will be a CollisionMsg</span>
<span class="sd">                print(data.x)</span>
<span class="sd">                print(data.y)</span>
<span class="sd">                print(data.axis)</span>
<span class="sd">                print(data.speed)</span>
<span class="sd">                print(data.timestamp)</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.register_collision_callback(callback)</span>
<span class="sd">                s.start_collision_detection(100, 50, 100, 50)</span>
<span class="sd">                time.sleep(10)</span>
<span class="sd">                s.stop_collision_detection()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collision_callback</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">_power_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notification</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses a power notification and calls the callback</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">notification</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_power_callback</span><span class="p">(</span><span class="n">parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_forward_L1_diag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is used to forwrard the L1 diagnostic call. It</span>
<span class="sd">        is treated differently becuase it is sent as an async message</span>
<span class="sd">        even though it is in response to a system call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;L1&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">:</span>
                <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span>
        <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_sensor_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        parses sensor data and forwards it to registered callback</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_data_stream</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sensor_callback</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_collision_detect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses collision events and calls teh callback</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;&gt;3hB2HbI&quot;</span>
        <span class="n">unpacked</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

        <span class="n">x_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x01</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">y_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x02</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">CollisionMsg</span><span class="p">(</span><span class="n">unpacked</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x_list</span> <span class="o">+</span>
                              <span class="n">y_list</span><span class="p">,</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collision_callback</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_recieve_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="spheropy.Sphero.BluetoothInfo" class="name">class <span class="ident">BluetoothInfo</span></p>
      
  
    <div class="desc"><p>BluetoothInfo(name, address, color)</p></div>
  <div class="source_cont">
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#spheropy.Sphero.BluetoothInfo">BluetoothInfo</a></li>
          <li>__builtin__.tuple</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="spheropy.Sphero.BluetoothInfo.address" class="name">var <span class="ident">address</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 1</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.BluetoothInfo.color" class="name">var <span class="ident">color</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 2</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.BluetoothInfo.name" class="name">var <span class="ident">name</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 0</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="spheropy.Sphero.CollisionMsg" class="name">class <span class="ident">CollisionMsg</span></p>
      
  
    <div class="desc"><p>CollisionMsg(x, y, z, axis, x_magnitude, y_magnitude, speed, timestamp)</p></div>
  <div class="source_cont">
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#spheropy.Sphero.CollisionMsg">CollisionMsg</a></li>
          <li>__builtin__.tuple</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="spheropy.Sphero.CollisionMsg.axis" class="name">var <span class="ident">axis</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 3</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.CollisionMsg.speed" class="name">var <span class="ident">speed</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 6</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.CollisionMsg.timestamp" class="name">var <span class="ident">timestamp</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 7</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.CollisionMsg.x" class="name">var <span class="ident">x</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 0</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.CollisionMsg.x_magnitude" class="name">var <span class="ident">x_magnitude</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 4</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.CollisionMsg.y" class="name">var <span class="ident">y</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 1</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.CollisionMsg.y_magnitude" class="name">var <span class="ident">y_magnitude</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 5</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.CollisionMsg.z" class="name">var <span class="ident">z</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 2</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="spheropy.Sphero.Color" class="name">class <span class="ident">Color</span></p>
      
  
    <div class="desc"><p>Color(r, g, b)</p></div>
  <div class="source_cont">
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#spheropy.Sphero.Color">Color</a></li>
          <li>__builtin__.tuple</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="spheropy.Sphero.Color.b" class="name">var <span class="ident">b</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 2</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.Color.g" class="name">var <span class="ident">g</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 1</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.Color.r" class="name">var <span class="ident">r</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 0</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="spheropy.Sphero.MotorState" class="name">class <span class="ident">MotorState</span></p>
      
  
    <div class="desc"><p>An enum to represent possible motor states</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.MotorState', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.MotorState" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">MotorState</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An enum to represent possible motor states</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">off</span> <span class="o">=</span> <span class="mh">0x00</span>
    <span class="n">forward</span> <span class="o">=</span> <span class="mh">0x01</span>
    <span class="n">reverse</span> <span class="o">=</span> <span class="mh">0x02</span>
    <span class="n">brake</span> <span class="o">=</span> <span class="mh">0x03</span>
    <span class="n">ignore</span> <span class="o">=</span> <span class="mh">0x04</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#spheropy.Sphero.MotorState">MotorState</a></li>
          <li>enum.Enum</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Class variables</h3>
            <div class="item">
            <p id="spheropy.Sphero.MotorState.brake" class="name">var <span class="ident">brake</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.MotorState.forward" class="name">var <span class="ident">forward</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.MotorState.ignore" class="name">var <span class="ident">ignore</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.MotorState.off" class="name">var <span class="ident">off</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.MotorState.reverse" class="name">var <span class="ident">reverse</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="spheropy.Sphero.MotorValue" class="name">class <span class="ident">MotorValue</span></p>
      
  
    <div class="desc"><p>MotorValue(mode, power)</p></div>
  <div class="source_cont">
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#spheropy.Sphero.MotorValue">MotorValue</a></li>
          <li>__builtin__.tuple</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="spheropy.Sphero.MotorValue.mode" class="name">var <span class="ident">mode</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 0</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.MotorValue.power" class="name">var <span class="ident">power</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 1</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="spheropy.Sphero.PacketTime" class="name">class <span class="ident">PacketTime</span></p>
      
  
    <div class="desc"><p>PacketTime(offset, delay)</p></div>
  <div class="source_cont">
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#spheropy.Sphero.PacketTime">PacketTime</a></li>
          <li>__builtin__.tuple</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="spheropy.Sphero.PacketTime.delay" class="name">var <span class="ident">delay</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 1</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.PacketTime.offset" class="name">var <span class="ident">offset</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 0</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="spheropy.Sphero.PowerState" class="name">class <span class="ident">PowerState</span></p>
      
  
    <div class="desc"><p>PowerState(recVer, power_state, batt_voltage, num_charges, time_since_chg)</p></div>
  <div class="source_cont">
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#spheropy.Sphero.PowerState">PowerState</a></li>
          <li>__builtin__.tuple</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="spheropy.Sphero.PowerState.batt_voltage" class="name">var <span class="ident">batt_voltage</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 2</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.PowerState.num_charges" class="name">var <span class="ident">num_charges</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 3</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.PowerState.power_state" class="name">var <span class="ident">power_state</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 1</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.PowerState.recVer" class="name">var <span class="ident">recVer</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 0</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.PowerState.time_since_chg" class="name">var <span class="ident">time_since_chg</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 4</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="spheropy.Sphero.Response" class="name">class <span class="ident">Response</span></p>
      
  
    <div class="desc"><p>Response(success, data)</p></div>
  <div class="source_cont">
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#spheropy.Sphero.Response">Response</a></li>
          <li>__builtin__.tuple</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="spheropy.Sphero.Response.data" class="name">var <span class="ident">data</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 1</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.Response.success" class="name">var <span class="ident">success</span></p>
            

            
  
    <div class="desc"><p>Alias for field number 0</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="spheropy.Sphero.Sphero" class="name">class <span class="ident">Sphero</span></p>
      
  
    <div class="desc"><p>Class representing a sphero. Can be used in a <code>with</code> block or managed explicitly.</p>
<p>All direct sphero commands will return a <code>Response</code> object. where <code>response.success</code>
indicates if the command ran successfully, and <code>response.data</code> will contain the
data of the response or what went wrong. Other returns will be specified</p>
<h3>Usage:</h3>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">spheropy.Sphero</span> <span class="kn">import</span> <span class="n">Sphero</span>
<span class="c1"># explicit managment</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Sphero</span><span class="p">(</span><span class="s2">&quot;Sphero-YWY&quot;</span><span class="p">,</span> <span class="s2">&quot;68:86:E7:07:59:71&quot;</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="c1"># starts receiving data from sphero</span>
<span class="n">s</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="c1"># context manager</span>
<span class="k">with</span> <span class="n">Sphero</span><span class="p">(</span><span class="s2">&quot;Sphero-YWY&quot;</span><span class="p">,</span> <span class="s2">&quot;68:86:E7:07:59:71&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">s</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Sphero</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class representing a sphero. Can be used in a `with` block or managed explicitly.</span>

<span class="sd">    All direct sphero commands will return a `Response` object. where `response.success`</span>
<span class="sd">    indicates if the command ran successfully, and `response.data` will contain the</span>
<span class="sd">    data of the response or what went wrong. Other returns will be specified</span>

<span class="sd">    ### Usage:</span>

<span class="sd">        #!python</span>
<span class="sd">        from spheropy.Sphero import Sphero</span>
<span class="sd">        # explicit managment</span>
<span class="sd">        s = Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;)</span>
<span class="sd">        s.connect()</span>
<span class="sd">        s.start() # starts receiving data from sphero</span>
<span class="sd">        s.roll(50, 0)</span>
<span class="sd">        s.exit()</span>

<span class="sd">        # context manager</span>
<span class="sd">        with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">            s.roll(50, 0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="c1"># Static Methods</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">find_spheros</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary from names to addresses of all available spheros</span>
<span class="sd">        `tries` indicates the number of scans to perform before returning results.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            found_spheros = Sphero.find_spheros()</span>
<span class="sd">            for key, value in found_sphero.iteritems():</span>
<span class="sd">                print(&quot;Name: {}\tAddress: {}&quot;.format(key, value))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">BluetoothWrapper</span><span class="o">.</span><span class="n">find_free_devices</span><span class="p">(</span><span class="n">tries</span><span class="o">=</span><span class="n">tries</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="s2">&quot;[Ss]phero&quot;</span><span class="p">)</span>


<span class="c1"># Working</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">response_time_out</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">number_tries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `name` is mostly used in printing error and information messages, usefull when working with</span>
<span class="sd">        more then one sphero.</span>

<span class="sd">        `address` is the bluetooth address and `port` is the RFCOMM port to use every sphero I&#39;ve used</span>
<span class="sd">        uses port 1 so you unless you have trouble connectng it shouldn&#39;t need to change.</span>

<span class="sd">        `response_time_out` indicates how long to wait in seconds for a response after a message</span>
<span class="sd">        that expects a response is sent ,it does not include sendng time.</span>

<span class="sd">        Any command will be sent up to `number_tries` untill it is successful. This only happens</span>
<span class="sd">        if a response is expected, otherwise it&#39;s sent once.  A single command</span>
<span class="sd">        with a response may block for up to `response_time_out` X `number_tries` seconds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Sphero</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span> <span class="o">=</span> <span class="n">BluetoothWrapper</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot; access to bluetooth wrapper, avoid using &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suppress_exception</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="sd">&quot;&quot;&quot; suppress_exceptions when used in `with` block &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_seq_num</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_tries</span> <span class="o">=</span> <span class="n">number_tries</span>
        <span class="sd">&quot;&quot;&quot; number of times to try to send a command to sphero &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_msg_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_SOP1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_time_out</span> <span class="o">=</span> <span class="n">response_time_out</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_recieve_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_recieve_loop</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_asyn_func</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mh">0x01</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_power_notification</span><span class="p">,</span>
            <span class="mh">0x02</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward_L1_diag</span><span class="p">,</span>
            <span class="mh">0x03</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sensor_data</span><span class="p">,</span>
            <span class="mh">0x07</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collision_detect</span><span class="p">,</span>
            <span class="c1"># 0x0B: self._self_level_result,</span>
            <span class="c1"># 0x0C: self._gyro_exceeded</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_sensor_callback</span> <span class="o">=</span> <span class="n">nothing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_power_callback</span> <span class="o">=</span> <span class="n">nothing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collision_callback</span> <span class="o">=</span> <span class="n">nothing</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; for use in contex manager &quot;&quot;&quot;</span>
        <span class="n">connected</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">tries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">connected</span> <span class="ow">and</span> <span class="n">tries</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_tries</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">suppress_exceptions</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">SpheroException</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">tries</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_tries</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SpheroException</span><span class="p">(</span><span class="s2">&quot;Unable to connect to sphero&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; for use in context manager &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppress_exception</span>

    <span class="k">def</span> <span class="nf">_recieve_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; recieves data from sphero and parses it&quot;&quot;&quot;</span>
        <span class="n">packet</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">is_connected</span><span class="p">():</span>
            <span class="c1"># state one</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">packet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="n">packet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">_SOP1</span><span class="p">:</span>
                    <span class="n">packet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                <span class="c1"># state two</span>
                <span class="n">packet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">packet_type</span> <span class="o">=</span> <span class="n">packet</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">packet_type</span> <span class="o">==</span> <span class="n">_ACKNOWLEDGMENT</span><span class="p">:</span>  <span class="c1"># Sync Packet</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_handle_acknowledge</span><span class="p">()</span>

                <span class="k">elif</span> <span class="n">packet_type</span> <span class="o">==</span> <span class="n">_ASYNC</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_handle_async</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">eprint</span><span class="p">(</span><span class="s2">&quot;Malformed Packet&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">SpheroException</span><span class="p">:</span>
                <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_handle_acknowledge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses response packets from sphero. Response added to a response dictionary</span>
<span class="sd">        as a Response tuple where tuple[0] indicates success and tuple[1] is the data,</span>
<span class="sd">        the thread waiting on the response is alerted to it via an event registered</span>
<span class="sd">        in the response_event_lookup dictionary, and is responsible for parsing the data.</span>
<span class="sd">        all access should be done with the response_lock.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msrp</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">length</span> <span class="o">==</span> <span class="mh">0xff</span><span class="p">:</span>
            <span class="k">pass</span>
            <span class="c1"># raise Exception(&quot;NOt Implemented _MSRP: {0}&quot;.format(_msrp))</span>
            <span class="c1"># TODO cover oxff cases</span>
        <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">msrp</span>
        <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span>
        <span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">length</span>
        <span class="n">checksum</span> <span class="o">=</span> <span class="n">check_sum</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">checksum</span><span class="p">:</span>
            <span class="n">eprint</span><span class="p">(</span><span class="s2">&quot;Malfromed Packet, recieved: {0} expected: {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">checksum</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">:</span>
                    <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="n">seq</span><span class="p">]</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="n">seq</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span>
            <span class="k">if</span> <span class="n">msrp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="p">[</span><span class="n">seq</span><span class="p">]</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span> <span class="n">length</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="p">[</span><span class="n">seq</span><span class="p">]</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span>
                    <span class="bp">False</span><span class="p">,</span> <span class="n">_MSRP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">msrp</span><span class="p">,</span> <span class="s2">&quot;UNKNOWN ERROR&quot;</span><span class="p">))</span>
            <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_handle_async</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles async (usually sensor) messages form sphero,</span>
<span class="sd">        It calls the a parser function which will call any regstered</span>
<span class="sd">        callback for each type of data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">id_code</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">length_msb</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">length_lsb</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">length</span> <span class="o">=</span> <span class="p">(</span><span class="n">length_msb</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">length_lsb</span>

        <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_code</span>
        <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">length_msb</span>
        <span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">length_lsb</span>
        <span class="n">checksum</span> <span class="o">=</span> <span class="n">check_sum</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">checksum</span><span class="p">:</span>
            <span class="n">eprint</span><span class="p">(</span><span class="s2">&quot;Malfromed Packet, recieved: {0} expected: {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">checksum</span><span class="p">))</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">tocall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_asyn_func</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">id_code</span><span class="p">,</span> <span class="n">nothing</span><span class="p">)</span>
            <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">tocall</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="p">,))</span>
            <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        reads a given length from the bluetooth, into a buffer, starting at a given offset</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">array</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span>
        <span class="n">to_read</span> <span class="o">=</span> <span class="n">length</span>
        <span class="k">while</span> <span class="n">to_read</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">to_read</span><span class="p">)</span>
            <span class="n">array</span> <span class="o">+=</span> <span class="n">out</span>
            <span class="n">to_read</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">array</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        used for assigning unique seq numbers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_seq_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_num</span> <span class="o">&gt;</span> <span class="mh">0xff</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_num</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_num</span>

    <span class="k">def</span> <span class="nf">_send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">did</span><span class="p">,</span> <span class="n">cid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sends data to sphero `did` is the device id, `cid` is the virtual core id</span>
<span class="sd">        for more information view sphero Docs.</span>

<span class="sd">        `data` is the data to send</span>

<span class="sd">        `response` indicates if a response is expected or not if it is it handles</span>
<span class="sd">        working with the event system, and blocks until response is recieved,</span>
<span class="sd">        or `self.response_time_out` elapses</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">seq_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">data_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
                <span class="n">seq_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq</span>
                <span class="n">event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="n">seq_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">event</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_msg_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ANSWER</span> <span class="k">if</span> <span class="n">response</span> <span class="k">else</span> <span class="n">_NO_ANSWER</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">did</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">cid</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq_number</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_length</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">6</span> <span class="o">+</span> <span class="n">data_length</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
            <span class="n">checksum</span> <span class="o">=</span> <span class="n">check_sum</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span> <span class="mi">6</span> <span class="o">+</span> <span class="n">data_length</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">6</span> <span class="o">+</span> <span class="n">data_length</span><span class="p">]</span> <span class="o">=</span> <span class="n">checksum</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
                <span class="nb">buffer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="mi">6</span> <span class="o">+</span> <span class="n">data_length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_response_time_out</span><span class="p">):</span>
                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="p">[</span><span class="n">seq_number</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Establishes a connection and</span>
<span class="sd">        returns a boolean indicating if the connection was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closes the connection to the sphero.</span>
<span class="sd">        If sphero is not connected the call has no effect.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_stable_send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">did</span><span class="p">,</span> <span class="n">cid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A version of send that tries untill successful</span>
<span class="sd">        if response is false it will only try once</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">success</span> <span class="ow">and</span> <span class="n">tries</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_tries</span><span class="p">:</span>
            <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="n">did</span><span class="p">,</span> <span class="n">cid</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
            <span class="n">tries</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">success</span> <span class="o">=</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span>
        <span class="k">return</span> <span class="n">reply</span>
<span class="c1"># CORE COMMANDS</span>

    <span class="k">def</span> <span class="nf">ping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Ping command is used to verify both a solid data link with the caller</span>
<span class="sd">        and that Sphero is awake and dispatching commands.</span>

<span class="sd">        A Response tuple is returned with response.success indicating if a response</span>
<span class="sd">        is received back from the sphero, there is no accompanying data.</span>

<span class="sd">        # Usage</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                response = s.ping()</span>
<span class="sd">                print(response.success)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;PING&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">get_versioning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A Response tuple is returned, if `response.success == True`, then</span>
<span class="sd">        `response.data` will contain a tuple of the bytes of the versioning info.</span>

<span class="sd">        see Sphero api docs for more info.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET VERSIONING&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s2">&quot;&gt;8B&quot;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">parsed</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">set_device_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This assigned name is held internally and produced as part of the Get Bluetooth Info</span>
<span class="sd">        service below. Names are clipped at 48 characters in length to support UTF - 8 sequences</span>
<span class="sd">        you can send something longer but the extra will be discarded.</span>
<span class="sd">        This field defaults to the Bluetooth advertising name.</span>

<span class="sd">        The returned Response objects data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET NAME&#39;</span><span class="p">],</span> <span class="n">name</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_bluetooth_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If successful the returned Response Object&#39;s data field</span>
<span class="sd">        is a BluetoothInfo object containing the textual</span>
<span class="sd">        name of the ball (defaults to the Bluetooth</span>
<span class="sd">        advertising name but can be changed), the Bluetooth address and</span>
<span class="sd">        the ID colors the ball blinks when not connected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET BLUETOOTH INFO&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;&gt;16s12sx3c&quot;</span>
            <span class="n">temp_tup</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)]</span>
            <span class="n">named_tuple</span> <span class="o">=</span> <span class="n">BluetoothInfo</span><span class="p">(</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">temp_tup</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">named_tuple</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">get_power_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If successful the response.data will contains a</span>
<span class="sd">        PowerState tuple with the following fields in this order.</span>

<span class="sd">            `recVer`: set to 1</span>

<span class="sd">            `powerState`: 1 = Charging, 2 = OK, 3 = Low, 4 = Critical</span>

<span class="sd">            `batt_voltage`: current battery voltage in 100ths of a volt</span>

<span class="sd">            `num_charges`: number of recharges in the lilfe of this sphero</span>

<span class="sd">            `time_since_chg`: seconds Awake</span>
<span class="sd">        `</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                response = s.get_power_state()</span>
<span class="sd">                if response.success:</span>
<span class="sd">                    power = response.data</span>
<span class="sd">                    print(&quot;power_state: {}&quot;.format(power.power_state))</span>
<span class="sd">                    print(&quot;Voltage: {}&quot;.format(power.batt_voltage))</span>
<span class="sd">                    print(&quot;Number Charges: {}&quot;.format(power.num_charges))</span>
<span class="sd">                    print(&quot;Time Since Charge: {}&quot;.format(power.time_since_chg))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET POWER STATE&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">parsed_answer</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;BBHHH&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">PowerState</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">parsed_answer</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">set_power_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setting</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets Async power notification messages to be sent. To access the notifications register a power_notfiation callback. Notifications</span>
<span class="sd">        are sent every 10 seconds</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="k">if</span> <span class="n">setting</span> <span class="k">else</span> <span class="mh">0x00</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET POWER NOTIFICATION&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">flag</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">sleep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wakeup_time</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This command puts Sphero to sleep immediately.</span>
<span class="sd">        The sphero will automaticall reawaken after `wakeup_time` seconds.</span>
<span class="sd">        Zero does not program a wakeup interval, so it sleeps forever.</span>

<span class="sd">        The Sphero must be reconnected after this function is called. However,</span>
<span class="sd">        most settings are preserved.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">wakeup_time</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">wakeup_time</span> <span class="o">&gt;</span> <span class="mh">0xffff</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="n">big</span> <span class="o">=</span> <span class="n">wakeup_time</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
        <span class="n">little</span> <span class="o">=</span> <span class="p">(</span><span class="n">wakeup_time</span> <span class="o">&amp;</span> <span class="mh">0x00ff</span><span class="p">)</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SLEEP&#39;</span><span class="p">],</span> <span class="p">[</span>
            <span class="n">big</span><span class="p">,</span> <span class="n">little</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">get_voltage_trip_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If successful the Response Object&#39;s data field contains a tuple of the</span>
<span class="sd">        voltage trip points for what Sphero considers Low and Critical battery.</span>
<span class="sd">        The values are expressed in 100ths of a volt,</span>
<span class="sd">        so the defaults of 7.00V and 6.50V respectively are returned as</span>
<span class="sd">        700 and 650.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET VOLTAGE TRIP&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">parse</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s2">&quot;&gt;HH&quot;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">parse</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">set_voltage_trip_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">critical</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DOES NOT WORK</span>
<span class="sd">        not implemented</span>
<span class="sd">        This assigns the voltage trip points for Low and Critical battery voltages.</span>
<span class="sd">        The values are specified in 100ths of a volt and</span>
<span class="sd">        the limitations on adjusting these away from their defaults are:</span>
<span class="sd">        Vlow must be in the range 675 to 725 ( += 25)</span>
<span class="sd">        Vcrit must be in the range 625 to 675 ( += 25)</span>
<span class="sd">        There must be 0.25V of separation between the two values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">False</span>
        <span class="n">low</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">crit</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">critical</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET VOLTAGE TRIP&#39;</span><span class="p">],</span> <span class="n">low</span> <span class="o">+</span> <span class="n">crit</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_inactivity_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets inactivity time out. Value must be greater than 60 seconds,</span>
<span class="sd">        is preserved across power cycles.</span>

<span class="sd">       The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">timeout</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">timeout</span> <span class="o">&gt;</span> <span class="mh">0xffff</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="n">big</span> <span class="o">=</span> <span class="n">timeout</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
        <span class="n">little</span> <span class="o">=</span> <span class="p">(</span><span class="n">timeout</span> <span class="o">&amp;</span> <span class="mh">0x00ff</span><span class="p">)</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET INACT TIMEOUT&#39;</span><span class="p">],</span> <span class="p">[</span>
            <span class="n">big</span><span class="p">,</span> <span class="n">little</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">L1_diag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a developer - level command to help diagnose aberrant behavior.</span>
<span class="sd">        Most system counters, process flags, and system states are decoded</span>
<span class="sd">        into human readable ASCII.</span>

<span class="sd">        If successful the Response Object&#39;s data field will contain an ASCII message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">event</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_response_time_out</span> <span class="o">*</span> <span class="mi">10</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;no data recieved&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">L2_diag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DOES NOT WORK</span>
<span class="sd">        This is a developers - only command to help diagnose aberrant behavior.</span>
<span class="sd">        It is much less informative than the Level 1 command</span>
<span class="sd">        but it is in binary format and easier to parse</span>
<span class="sd">        Command not found</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;L2&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">assign_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_value</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the internal timer to `time_value`. </span>
<span class="sd">        This is the time that shows up in a collision message.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;ASSIGN TIME&#39;</span><span class="p">],</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">time_value</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">poll_packet_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Command to help profile latencies</span>
<span class="sd">        returns a PacketTime tuple with fields:</span>
<span class="sd">        offset: the maximum - likelihood time offset of the Client clock to sphero&#39;s system clock</span>
<span class="sd">        delay: round - trip delay between client a sphero</span>

<span class="sd">        DOESN&quot;T REALLY WORK YET....</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO time 1 gets mangled.</span>
        <span class="n">time1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
        <span class="n">bit1</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0xff000000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span>
        <span class="n">bit2</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0x00ff0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
        <span class="n">bit3</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0x0000ff00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
        <span class="n">bit4</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0x000000ff</span><span class="p">)</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;POLL PACKET TIMES&#39;</span><span class="p">],</span> <span class="p">[</span>
            <span class="n">bit1</span><span class="p">,</span> <span class="n">bit2</span><span class="p">,</span> <span class="n">bit3</span><span class="p">,</span> <span class="n">bit4</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">time4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
        <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">sphero_time</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;III&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> \
                <span class="p">((</span><span class="n">sphero_time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sphero_time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">sphero_time</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">time4</span><span class="p">))</span>
            <span class="n">delay</span> <span class="o">=</span> <span class="p">(</span><span class="n">time4</span> <span class="o">-</span> <span class="n">sphero_time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> \
                <span class="p">(</span><span class="n">sphero_time</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">sphero_time</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">PacketTime</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>

<span class="c1"># _SPHERO COMMANDS</span>

    <span class="k">def</span> <span class="nf">set_heading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">heading</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the spheros heading in degrees,</span>
<span class="sd">        heading must range between 0 to 359. This should move the</span>
<span class="sd">        back tail light.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">heading</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">heading</span> <span class="o">&gt;</span> <span class="mi">359</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;heading must be between 0 and 359&quot;</span><span class="p">)</span>

        <span class="n">heading_bytes</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">heading</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET HEADING&#39;</span><span class="p">],</span> <span class="n">heading_bytes</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reply</span>

    <span class="k">def</span> <span class="nf">set_stabilization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stablize</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This turns on or off the internal stabilization of Sphero,</span>
<span class="sd">        the IMU is used to match the ball&#39;s orientation to its set points.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="k">if</span> <span class="n">stablize</span> <span class="k">else</span> <span class="mh">0x00</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET STABILIZATION&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">flag</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_rotation_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        DOESN&#39;t WORK</span>
<span class="sd">        This sets the roation rate sphero will use to meet new heading commands</span>
<span class="sd">        Lower value offers better control, with a larger turning radius.</span>
<span class="sd">        The rate should be in degrees / sec,</span>
<span class="sd">        anythin above 199 the maxium value is used(400 degrees / sec)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO returns unknown command</span>
        <span class="k">if</span> <span class="n">rate</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;USE POSITIVE RATE ONLY&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rate</span> <span class="o">&gt;</span> <span class="mi">199</span><span class="p">:</span>
            <span class="n">rate</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rate</span> <span class="o">/</span> <span class="mf">0.784</span><span class="p">)</span>
        <span class="n">to_bytes</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET ROTATION RATE&#39;</span><span class="p">],</span> <span class="n">to_bytes</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_chassis_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the Chassis ID as an int.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET CHASSIS ID&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">tup</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;H&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span>

    <span class="k">def</span> <span class="nf">set_data_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream_settings</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">packet_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets data stream options, where `stream_settings` is a DataStreamManager object,</span>
<span class="sd">        and `frequency` how often you want to recieve data and `packet_count` indicates</span>
<span class="sd">        the number of packets you want to recieve, set to zero for unlimited streaming.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>
<span class="sd">            from spheropy.DataStream import DataStreamManager</span>

<span class="sd">            dsm = DataStreamManager()</span>
<span class="sd">            dsm.acc = True</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.set_data_stream(dsm, 10 packet_count=2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span> <span class="o">=</span> <span class="n">stream_settings</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">divisor</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">400.0</span> <span class="o">/</span> <span class="n">frequency</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span><span class="o">.</span><span class="n">number_frames</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mask1</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span><span class="o">.</span><span class="n">mask1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">mask2</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span><span class="o">.</span><span class="n">mask2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">divisor</span> <span class="o">+</span> <span class="n">samples</span> <span class="o">+</span> <span class="n">mask1</span> <span class="o">+</span> <span class="p">[</span><span class="n">packet_count</span><span class="p">]</span> <span class="o">+</span> <span class="n">mask2</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET DATA STRM&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop_data_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        stops data streaming</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET DATA STRM&#39;</span><span class="p">],</span> <span class="p">[</span>
                                   <span class="mh">0xff</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">start_collision_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_threshold</span><span class="p">,</span> <span class="n">x_speed</span><span class="p">,</span> <span class="n">y_threshold</span><span class="p">,</span> <span class="n">y_speed</span><span class="p">,</span> <span class="n">dead</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts collision detection. `Threshold` values represent the max threshold,</span>
<span class="sd">        and `speed` is added to the thresholds to rang detection by the spheros speed,</span>
<span class="sd">        `dead` is the minimum time between detections</span>
<span class="sd">        in ms. all data must be in the range 0...255</span>

<span class="sd">        For more infomation see Collision Detection pdf</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">method</span> <span class="o">=</span> <span class="mh">0x01</span>
        <span class="n">dead</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dead</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET COLLISION DETECT&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">method</span><span class="p">,</span> <span class="n">x_threshold</span><span class="p">,</span> <span class="n">x_speed</span><span class="p">,</span> <span class="n">y_threshold</span><span class="p">,</span> <span class="n">y_speed</span><span class="p">,</span> <span class="n">dead</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop_collision_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops collision detection</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET COLLISION DETECT&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the color of the sphero given rgb components between 0 and 255,</span>
<span class="sd">        if `default` is true, sphero will default to that color when first connected</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from time import sleep</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.set_color(255, 0, 0)</span>
<span class="sd">                sleep(1)</span>
<span class="sd">                s.set_color(0, 255, 0)</span>
<span class="sd">                sleep(1)</span>
<span class="sd">                s.set_color(0, 0, 255)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">red</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">red</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">blue</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">blue</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">green</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">green</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x01</span><span class="p">]</span> <span class="k">if</span> <span class="n">default</span> <span class="k">else</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET COLOR&#39;</span><span class="p">],</span> <span class="n">red</span> <span class="o">+</span> <span class="n">green</span> <span class="o">+</span> <span class="n">blue</span> <span class="o">+</span> <span class="n">flag</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_back_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brightness</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Controls the brightness of the back LED, non persistent</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">brightness</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">brightness</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET BACKLIGHT&#39;</span><span class="p">],</span> <span class="n">brightness</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If sucessful `response.data` contains the sphero default</span>
<span class="sd">        Color, may not be the current color shown.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                response = s.get_color()</span>
<span class="sd">                if response.success:</span>
<span class="sd">                    color = response.data</span>
<span class="sd">                    print(&quot;r: {}  b: {}  g: {}&quot;.format(color.r, color.b, color.g))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET COLOR&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">parse</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;BBB&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">Color</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">parse</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">response</span>

    <span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">heading</span><span class="p">,</span> <span class="n">fast_rotate</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Commands the sphero to move. `speed` ranges from 0..255, while `heading` is</span>
<span class="sd">        in degrees from 0..359, 0 is strait, 90 is to the right, 180 is back and</span>
<span class="sd">        270 is to the left. When `fast_rotate` is set to True sphero will rotate as</span>
<span class="sd">        quickly as possible to given heading regardless of speed.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gobit</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x02</span><span class="p">]</span> <span class="k">if</span> <span class="n">fast_rotate</span> <span class="k">else</span> <span class="p">[</span><span class="mh">0x01</span><span class="p">]</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">heading</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">heading</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;ROLL&#39;</span><span class="p">],</span> <span class="n">speed</span> <span class="o">+</span> <span class="n">heading</span> <span class="o">+</span> <span class="n">gobit</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Commands the Shero to stop.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;ROLL&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">boost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">activate</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Activates or deactivates boost, depending on the truth value of `activate`.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">activate</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="k">if</span> <span class="n">activate</span> <span class="k">else</span> <span class="mh">0x00</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;BOOST&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">activate</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_raw_motor_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_value</span><span class="p">,</span> <span class="n">right_value</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows direct controle of the motors</span>
<span class="sd">        both motor values should be MotorValue tuple</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lmode</span> <span class="o">=</span> <span class="n">left_value</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
        <span class="n">lpower</span> <span class="o">=</span> <span class="n">left_value</span><span class="o">.</span><span class="n">power</span>
        <span class="n">rmode</span> <span class="o">=</span> <span class="n">right_value</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
        <span class="n">rpower</span> <span class="o">=</span> <span class="n">right_value</span><span class="o">.</span><span class="n">power</span>
        <span class="k">if</span> <span class="n">outside_range</span><span class="p">(</span><span class="n">lpower</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="ow">or</span> <span class="n">outside_range</span><span class="p">(</span><span class="n">rpower</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SpheroException</span><span class="p">(</span><span class="s2">&quot;Values outside of range&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">lmode</span><span class="p">,</span> <span class="n">lpower</span><span class="p">,</span> <span class="n">rmode</span><span class="p">,</span> <span class="n">rpower</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET RAW MOTOR&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_motion_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This sets the ultimate timeout for the last motion command</span>
<span class="sd">        to keep Sphero from rolling away</span>
<span class="sd">        timeout is in miliseconds and defaults to 2000</span>
<span class="sd">        for this to be in effect motion timeout must be</span>
<span class="sd">        in must be set in permanent options</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outside_range</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xFFFF</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SpheroException</span><span class="p">(</span><span class="s2">&quot;Timeout outside of valid range&quot;</span><span class="p">)</span>
        <span class="n">timeout</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;MOTION TIMEOUT&#39;</span><span class="p">],</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_permanent_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set Options, for option information see PermanentOptionFlag docs.</span>
<span class="sd">        Options persist across power cycles. `options` is a Permanent Option Object</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>
<span class="sd">            from spheropy.Options import PermanentOptions</span>

<span class="sd">            po = PermanentOptions()</span>
<span class="sd">            po.set_light_wakeup_sensitivity= True</span>
<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.set_permanent_options(po)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">bitflags</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET PERM OPTIONS&#39;</span><span class="p">],</span> <span class="n">options</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_permanent_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If successful `result.data` contains the Permenent Options of the sphero</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET PERM OPTIONS&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="n">settings</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;Q&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">PermanentOptions</span><span class="p">()</span>
            <span class="n">options</span><span class="o">.</span><span class="n">bitflags</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">set_stop_on_disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets sphero to stop on disconnect, this is a one_shot, so it must be reset on reconnect.</span>

<span class="sd">        Set `value` to false to turn off behavior.</span>

<span class="sd">        The returned Response object&#39;s data field will be empty,</span>
<span class="sd">        but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">        will indicate if the command was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET TEMP OPTIONS&#39;</span><span class="p">],</span> <span class="p">[</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">will_stop_on_disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns if the sphero will stop when it is disconnected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
            <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET TEMP OPTOINS&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>
<span class="c1"># ASYNC</span>

    <span class="k">def</span> <span class="nf">register_sensor_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a function to call when a sensor message is recieved.</span>
<span class="sd">        `func` must be callable and it will be started in its own thread</span>
<span class="sd">        as not to block the recieve loop.</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            from time import sleep</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            dsm = DataStreamManager()</span>
<span class="sd">            dsm.acc = True</span>
<span class="sd">            dsm.odom = True</span>

<span class="sd">            #assume acc and odom sensor messages have be requested</span>
<span class="sd">            def callback(sensor_data):</span>
<span class="sd">                #sensor_data will be an array of dictionaries where</span>
<span class="sd">                #each item is a frame sent by the sphero</span>
<span class="sd">                for  frames in sensor_data:</span>
<span class="sd">                    print(frames[&#39;acc&#39;])</span>
<span class="sd">                    print(frames[&#39;odom&#39;])</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.register_sensor_callback(callback)</span>
<span class="sd">                s.set_data_stream(dsm, 10 packet_count=2)</span>
<span class="sd">                # callback will be called twice</span>
<span class="sd">                sleep(1) # so data will be recieved before exit</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sensor_callback</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">register_power_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register a function to call when an async power notification is recieved. `func` must be callable and it will be started in it&#39;s own thread. The call back will recieve an integer with:</span>

<span class="sd">        1 = charging</span>

<span class="sd">        2 = OK</span>

<span class="sd">        3 = Low</span>

<span class="sd">        4 = Critical </span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            import time</span>
<span class="sd">            from sphropy.Sphero import Sphero</span>

<span class="sd">            def callback(notification):</span>
<span class="sd">                print(notification)</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.register_power_callback(callback)</span>
<span class="sd">                s.set_power_notification(True)</span>
<span class="sd">                time.sleep(20)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_power_callback</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">register_collision_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Registers a callback function for asyn collision notifications.</span>
<span class="sd">        `func` must be callable and it is started in it&#39;s own thread</span>

<span class="sd">        ### Usage:</span>

<span class="sd">            #!python</span>
<span class="sd">            import time</span>
<span class="sd">            from spheropy.Sphero import Sphero</span>

<span class="sd">            def callback(data):</span>
<span class="sd">                #data will be a CollisionMsg</span>
<span class="sd">                print(data.x)</span>
<span class="sd">                print(data.y)</span>
<span class="sd">                print(data.axis)</span>
<span class="sd">                print(data.speed)</span>
<span class="sd">                print(data.timestamp)</span>

<span class="sd">            with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">                s.register_collision_callback(callback)</span>
<span class="sd">                s.start_collision_detection(100, 50, 100, 50)</span>
<span class="sd">                time.sleep(10)</span>
<span class="sd">                s.stop_collision_detection()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collision_callback</span> <span class="o">=</span> <span class="n">func</span>

    <span class="k">def</span> <span class="nf">_power_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">notification</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses a power notification and calls the callback</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">notification</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_power_callback</span><span class="p">(</span><span class="n">parsed</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_forward_L1_diag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is used to forwrard the L1 diagnostic call. It</span>
<span class="sd">        is treated differently becuase it is sent as an async message</span>
<span class="sd">        even though it is in response to a system call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;L1&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">:</span>
                <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span>
        <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_sensor_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        parses sensor data and forwards it to registered callback</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_data_stream</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sensor_callback</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_collision_detect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses collision events and calls teh callback</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;&gt;3hB2HbI&quot;</span>
        <span class="n">unpacked</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

        <span class="n">x_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x01</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">y_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x02</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">CollisionMsg</span><span class="p">(</span><span class="n">unpacked</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">x_list</span> <span class="o">+</span>
                              <span class="n">y_list</span><span class="p">,</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">unpacked</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collision_callback</span><span class="p">(</span><span class="n">parsed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_recieve_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#spheropy.Sphero.Sphero">Sphero</a></li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="spheropy.Sphero.Sphero.bluetooth" class="name">var <span class="ident">bluetooth</span></p>
            

            
  
    <div class="desc"><p>access to bluetooth wrapper, avoid using</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.Sphero.number_tries" class="name">var <span class="ident">number_tries</span></p>
            

            
  
    <div class="desc"><p>number of times to try to send a command to sphero</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="spheropy.Sphero.Sphero.suppress_exception" class="name">var <span class="ident">suppress_exception</span></p>
            

            
  
    <div class="desc"><p>suppress_exceptions when used in <code>with</code> block</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, name, address, port=1, response_time_out=1, number_tries=5)</p>
    </div>
    

    
  
    <div class="desc"><p><code>name</code> is mostly used in printing error and information messages, usefull when working with
more then one sphero.</p>
<p><code>address</code> is the bluetooth address and <code>port</code> is the RFCOMM port to use every sphero I've used
uses port 1 so you unless you have trouble connectng it shouldn't need to change.</p>
<p><code>response_time_out</code> indicates how long to wait in seconds for a response after a message
that expects a response is sent ,it does not include sendng time.</p>
<p>Any command will be sent up to <code>number_tries</code> untill it is successful. This only happens
if a response is expected, otherwise it's sent once.  A single command
with a response may block for up to <code>response_time_out</code> X <code>number_tries</code> seconds</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.__init__', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">response_time_out</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">number_tries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    `name` is mostly used in printing error and information messages, usefull when working with</span>
<span class="sd">    more then one sphero.</span>
<span class="sd">    `address` is the bluetooth address and `port` is the RFCOMM port to use every sphero I&#39;ve used</span>
<span class="sd">    uses port 1 so you unless you have trouble connectng it shouldn&#39;t need to change.</span>
<span class="sd">    `response_time_out` indicates how long to wait in seconds for a response after a message</span>
<span class="sd">    that expects a response is sent ,it does not include sendng time.</span>
<span class="sd">    Any command will be sent up to `number_tries` untill it is successful. This only happens</span>
<span class="sd">    if a response is expected, otherwise it&#39;s sent once.  A single command</span>
<span class="sd">    with a response may block for up to `response_time_out` X `number_tries` seconds</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Sphero</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span> <span class="o">=</span> <span class="n">BluetoothWrapper</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot; access to bluetooth wrapper, avoid using &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">suppress_exception</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="sd">&quot;&quot;&quot; suppress_exceptions when used in `with` block &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_seq_num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number_tries</span> <span class="o">=</span> <span class="n">number_tries</span>
    <span class="sd">&quot;&quot;&quot; number of times to try to send a command to sphero &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_msg_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">_SOP1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_response_time_out</span> <span class="o">=</span> <span class="n">response_time_out</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_recieve_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_recieve_loop</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_asyn_func</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mh">0x01</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_power_notification</span><span class="p">,</span>
        <span class="mh">0x02</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forward_L1_diag</span><span class="p">,</span>
        <span class="mh">0x03</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sensor_data</span><span class="p">,</span>
        <span class="mh">0x07</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collision_detect</span><span class="p">,</span>
        <span class="c1"># 0x0B: self._self_level_result,</span>
        <span class="c1"># 0x0C: self._gyro_exceeded</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sensor_callback</span> <span class="o">=</span> <span class="n">nothing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_power_callback</span> <span class="o">=</span> <span class="n">nothing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_collision_callback</span> <span class="o">=</span> <span class="n">nothing</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.L1_diag">
    <p>def <span class="ident">L1_diag</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>This is a developer - level command to help diagnose aberrant behavior.
Most system counters, process flags, and system states are decoded
into human readable ASCII.</p>
<p>If successful the Response Object's data field will contain an ASCII message.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.L1_diag', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.L1_diag" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">L1_diag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a developer - level command to help diagnose aberrant behavior.</span>
<span class="sd">    Most system counters, process flags, and system states are decoded</span>
<span class="sd">    into human readable ASCII.</span>
<span class="sd">    If successful the Response Object&#39;s data field will contain an ASCII message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">event</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
        <span class="n">event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_response_event_lookup</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">event</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_response_time_out</span> <span class="o">*</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_response_lock</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_responses</span><span class="p">[</span><span class="s1">&#39;L1&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;no data recieved&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.L2_diag">
    <p>def <span class="ident">L2_diag</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>DOES NOT WORK
This is a developers - only command to help diagnose aberrant behavior.
It is much less informative than the Level 1 command
but it is in binary format and easier to parse
Command not found</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.L2_diag', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.L2_diag" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">L2_diag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DOES NOT WORK</span>
<span class="sd">    This is a developers - only command to help diagnose aberrant behavior.</span>
<span class="sd">    It is much less informative than the Level 1 command</span>
<span class="sd">    but it is in binary format and easier to parse</span>
<span class="sd">    Command not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;L2&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.assign_time">
    <p>def <span class="ident">assign_time</span>(</p><p>self, time_value, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Sets the internal timer to <code>time_value</code>. 
This is the time that shows up in a collision message.</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.assign_time', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.assign_time" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">assign_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_value</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the internal timer to `time_value`. </span>
<span class="sd">    This is the time that shows up in a collision message.</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;ASSIGN TIME&#39;</span><span class="p">],</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">time_value</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.boost">
    <p>def <span class="ident">boost</span>(</p><p>self, activate, response=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Activates or deactivates boost, depending on the truth value of <code>activate</code>.</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.boost', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.boost" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">boost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">activate</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Activates or deactivates boost, depending on the truth value of `activate`.</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">activate</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="k">if</span> <span class="n">activate</span> <span class="k">else</span> <span class="mh">0x00</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;BOOST&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">activate</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.connect">
    <p>def <span class="ident">connect</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Establishes a connection and
returns a boolean indicating if the connection was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.connect', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.connect" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Establishes a connection and</span>
<span class="sd">    returns a boolean indicating if the connection was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.disconnect">
    <p>def <span class="ident">disconnect</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Closes the connection to the sphero.
If sphero is not connected the call has no effect.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.disconnect', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.disconnect" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Closes the connection to the sphero.</span>
<span class="sd">    If sphero is not connected the call has no effect.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bluetooth</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.find_spheros">
    <p>def <span class="ident">find_spheros</span>(</p><p>cls, tries=5)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a dictionary from names to addresses of all available spheros
<code>tries</code> indicates the number of scans to perform before returning results.</p>
<h3>Usage:</h3>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">spheropy.Sphero</span> <span class="kn">import</span> <span class="n">Sphero</span>

<span class="n">found_spheros</span> <span class="o">=</span> <span class="n">Sphero</span><span class="o">.</span><span class="n">find_spheros</span><span class="p">()</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">found_sphero</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Name: {} Address: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.find_spheros', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.find_spheros" class="source">
    <div class="codehilite"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">find_spheros</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tries</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a dictionary from names to addresses of all available spheros</span>
<span class="sd">    `tries` indicates the number of scans to perform before returning results.</span>
<span class="sd">    ### Usage:</span>
<span class="sd">        #!python</span>
<span class="sd">        from spheropy.Sphero import Sphero</span>
<span class="sd">        found_spheros = Sphero.find_spheros()</span>
<span class="sd">        for key, value in found_sphero.iteritems():</span>
<span class="sd">            print(&quot;Name: {}\tAddress: {}&quot;.format(key, value))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">BluetoothWrapper</span><span class="o">.</span><span class="n">find_free_devices</span><span class="p">(</span><span class="n">tries</span><span class="o">=</span><span class="n">tries</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="s2">&quot;[Ss]phero&quot;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.get_bluetooth_info">
    <p>def <span class="ident">get_bluetooth_info</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>If successful the returned Response Object's data field
is a BluetoothInfo object containing the textual
name of the ball (defaults to the Bluetooth
advertising name but can be changed), the Bluetooth address and
the ID colors the ball blinks when not connected.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.get_bluetooth_info', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.get_bluetooth_info" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_bluetooth_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If successful the returned Response Object&#39;s data field</span>
<span class="sd">    is a BluetoothInfo object containing the textual</span>
<span class="sd">    name of the ball (defaults to the Bluetooth</span>
<span class="sd">    advertising name but can be changed), the Bluetooth address and</span>
<span class="sd">    the ID colors the ball blinks when not connected.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET BLUETOOTH INFO&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;&gt;16s12sx3c&quot;</span>
        <span class="n">temp_tup</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="n">fmt</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)]</span>
        <span class="n">named_tuple</span> <span class="o">=</span> <span class="n">BluetoothInfo</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">temp_tup</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">temp_tup</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">named_tuple</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.get_chassis_id">
    <p>def <span class="ident">get_chassis_id</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the Chassis ID as an int.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.get_chassis_id', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.get_chassis_id" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_chassis_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the Chassis ID as an int.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET CHASSIS ID&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="n">tup</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;H&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.get_color">
    <p>def <span class="ident">get_color</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>If sucessful <code>response.data</code> contains the sphero default
Color, may not be the current color shown.</p>
<h3>Usage:</h3>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">spheropy.Sphero</span> <span class="kn">import</span> <span class="n">Sphero</span>

<span class="k">with</span> <span class="n">Sphero</span><span class="p">(</span><span class="s2">&quot;Sphero-YWY&quot;</span><span class="p">,</span> <span class="s2">&quot;68:86:E7:07:59:71&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;r: {}  b: {}  g: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">color</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">color</span><span class="o">.</span><span class="n">g</span><span class="p">))</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.get_color', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.get_color" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If sucessful `response.data` contains the sphero default</span>
<span class="sd">    Color, may not be the current color shown.</span>
<span class="sd">    ### Usage:</span>
<span class="sd">        #!python</span>
<span class="sd">        from spheropy.Sphero import Sphero</span>
<span class="sd">        with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">            response = s.get_color()</span>
<span class="sd">            if response.success:</span>
<span class="sd">                color = response.data</span>
<span class="sd">                print(&quot;r: {}  b: {}  g: {}&quot;.format(color.r, color.b, color.g))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET COLOR&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="n">parse</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;BBB&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">Color</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">parse</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.get_permanent_options">
    <p>def <span class="ident">get_permanent_options</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>If successful <code>result.data</code> contains the Permenent Options of the sphero</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.get_permanent_options', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.get_permanent_options" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_permanent_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If successful `result.data` contains the Permenent Options of the sphero</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET PERM OPTIONS&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;Q&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">PermanentOptions</span><span class="p">()</span>
        <span class="n">options</span><span class="o">.</span><span class="n">bitflags</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.get_power_state">
    <p>def <span class="ident">get_power_state</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>If successful the response.data will contains a
PowerState tuple with the following fields in this order.</p>
<div class="codehilite"><pre><span></span>`recVer`: set to 1

`powerState`: 1 = Charging, 2 = OK, 3 = Low, 4 = Critical

`batt_voltage`: current battery voltage in 100ths of a volt

`num_charges`: number of recharges in the lilfe of this sphero

`time_since_chg`: seconds Awake
</pre></div>


<p>`</p>
<h3>Usage:</h3>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">spheropy.Sphero</span> <span class="kn">import</span> <span class="n">Sphero</span>

<span class="k">with</span> <span class="n">Sphero</span><span class="p">(</span><span class="s2">&quot;Sphero-YWY&quot;</span><span class="p">,</span> <span class="s2">&quot;68:86:E7:07:59:71&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get_power_state</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="n">power</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;power_state: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">power</span><span class="o">.</span><span class="n">power_state</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Voltage: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">power</span><span class="o">.</span><span class="n">batt_voltage</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Number Charges: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">power</span><span class="o">.</span><span class="n">num_charges</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Time Since Charge: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">power</span><span class="o">.</span><span class="n">time_since_chg</span><span class="p">))</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.get_power_state', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.get_power_state" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_power_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If successful the response.data will contains a</span>
<span class="sd">    PowerState tuple with the following fields in this order.</span>
<span class="sd">        `recVer`: set to 1</span>
<span class="sd">        `powerState`: 1 = Charging, 2 = OK, 3 = Low, 4 = Critical</span>
<span class="sd">        `batt_voltage`: current battery voltage in 100ths of a volt</span>
<span class="sd">        `num_charges`: number of recharges in the lilfe of this sphero</span>
<span class="sd">        `time_since_chg`: seconds Awake</span>
<span class="sd">    `</span>
<span class="sd">    ### Usage:</span>
<span class="sd">        #!python</span>
<span class="sd">        from spheropy.Sphero import Sphero</span>
<span class="sd">        with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">            response = s.get_power_state()</span>
<span class="sd">            if response.success:</span>
<span class="sd">                power = response.data</span>
<span class="sd">                print(&quot;power_state: {}&quot;.format(power.power_state))</span>
<span class="sd">                print(&quot;Voltage: {}&quot;.format(power.batt_voltage))</span>
<span class="sd">                print(&quot;Number Charges: {}&quot;.format(power.num_charges))</span>
<span class="sd">                print(&quot;Time Since Charge: {}&quot;.format(power.time_since_chg))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET POWER STATE&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="n">parsed_answer</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;BBHHH&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">PowerState</span><span class="o">.</span><span class="n">_make</span><span class="p">(</span><span class="n">parsed_answer</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">reply</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.get_versioning">
    <p>def <span class="ident">get_versioning</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>A Response tuple is returned, if <code>response.success == True</code>, then
<code>response.data</code> will contain a tuple of the bytes of the versioning info.</p>
<p>see Sphero api docs for more info.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.get_versioning', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.get_versioning" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_versioning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Response tuple is returned, if `response.success == True`, then</span>
<span class="sd">    `response.data` will contain a tuple of the bytes of the versioning info.</span>
<span class="sd">    see Sphero api docs for more info.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET VERSIONING&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s2">&quot;&gt;8B&quot;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">parsed</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">reply</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.get_voltage_trip_points">
    <p>def <span class="ident">get_voltage_trip_points</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>If successful the Response Object's data field contains a tuple of the
voltage trip points for what Sphero considers Low and Critical battery.
The values are expressed in 100ths of a volt,
so the defaults of 7.00V and 6.50V respectively are returned as
700 and 650.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.get_voltage_trip_points', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.get_voltage_trip_points" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_voltage_trip_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If successful the Response Object&#39;s data field contains a tuple of the</span>
<span class="sd">    voltage trip points for what Sphero considers Low and Critical battery.</span>
<span class="sd">    The values are expressed in 100ths of a volt,</span>
<span class="sd">    so the defaults of 7.00V and 6.50V respectively are returned as</span>
<span class="sd">    700 and 650.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET VOLTAGE TRIP&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="n">parse</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s2">&quot;&gt;HH&quot;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">parse</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">reply</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.ping">
    <p>def <span class="ident">ping</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>The Ping command is used to verify both a solid data link with the caller
and that Sphero is awake and dispatching commands.</p>
<p>A Response tuple is returned with response.success indicating if a response
is received back from the sphero, there is no accompanying data.</p>
<h1>Usage</h1>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">spheropy.Sphero</span> <span class="kn">import</span> <span class="n">Sphero</span>

<span class="k">with</span> <span class="n">Sphero</span><span class="p">(</span><span class="s2">&quot;Sphero-YWY&quot;</span><span class="p">,</span> <span class="s2">&quot;68:86:E7:07:59:71&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">ping</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">success</span><span class="p">)</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.ping', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.ping" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">ping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Ping command is used to verify both a solid data link with the caller</span>
<span class="sd">    and that Sphero is awake and dispatching commands.</span>
<span class="sd">    A Response tuple is returned with response.success indicating if a response</span>
<span class="sd">    is received back from the sphero, there is no accompanying data.</span>
<span class="sd">    # Usage</span>
<span class="sd">        #!python</span>
<span class="sd">        from spheropy.Sphero import Sphero</span>
<span class="sd">        with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">            response = s.ping()</span>
<span class="sd">            print(response.success)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;PING&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">reply</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.poll_packet_times">
    <p>def <span class="ident">poll_packet_times</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Command to help profile latencies
returns a PacketTime tuple with fields:
offset: the maximum - likelihood time offset of the Client clock to sphero's system clock
delay: round - trip delay between client a sphero</p>
<p>DOESN"T REALLY WORK YET....</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.poll_packet_times', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.poll_packet_times" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">poll_packet_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Command to help profile latencies</span>
<span class="sd">    returns a PacketTime tuple with fields:</span>
<span class="sd">    offset: the maximum - likelihood time offset of the Client clock to sphero&#39;s system clock</span>
<span class="sd">    delay: round - trip delay between client a sphero</span>
<span class="sd">    DOESN&quot;T REALLY WORK YET....</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO time 1 gets mangled.</span>
    <span class="n">time1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span>
    <span class="n">bit1</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0xff000000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span>
    <span class="n">bit2</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0x00ff0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
    <span class="n">bit3</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0x0000ff00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
    <span class="n">bit4</span> <span class="o">=</span> <span class="p">(</span><span class="n">time1</span> <span class="o">&amp;</span> <span class="mh">0x000000ff</span><span class="p">)</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;POLL PACKET TIMES&#39;</span><span class="p">],</span> <span class="p">[</span>
        <span class="n">bit1</span><span class="p">,</span> <span class="n">bit2</span><span class="p">,</span> <span class="n">bit3</span><span class="p">,</span> <span class="n">bit4</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
    <span class="n">time4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
    <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="n">sphero_time</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s1">&#39;&gt;III&#39;</span><span class="p">,</span> <span class="nb">buffer</span><span class="p">(</span><span class="n">reply</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> \
            <span class="p">((</span><span class="n">sphero_time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sphero_time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="n">sphero_time</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">time4</span><span class="p">))</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="p">(</span><span class="n">time4</span> <span class="o">-</span> <span class="n">sphero_time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> \
            <span class="p">(</span><span class="n">sphero_time</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">sphero_time</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">PacketTime</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.register_collision_callback">
    <p>def <span class="ident">register_collision_callback</span>(</p><p>self, func)</p>
    </div>
    

    
  
    <div class="desc"><p>Registers a callback function for asyn collision notifications.
<code>func</code> must be callable and it is started in it's own thread</p>
<h3>Usage:</h3>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">spheropy.Sphero</span> <span class="kn">import</span> <span class="n">Sphero</span>

<span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c1">#data will be a CollisionMsg</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">speed</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>

<span class="k">with</span> <span class="n">Sphero</span><span class="p">(</span><span class="s2">&quot;Sphero-YWY&quot;</span><span class="p">,</span> <span class="s2">&quot;68:86:E7:07:59:71&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">s</span><span class="o">.</span><span class="n">register_collision_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">start_collision_detection</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">stop_collision_detection</span><span class="p">()</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.register_collision_callback', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.register_collision_callback" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_collision_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Registers a callback function for asyn collision notifications.</span>
<span class="sd">    `func` must be callable and it is started in it&#39;s own thread</span>
<span class="sd">    ### Usage:</span>
<span class="sd">        #!python</span>
<span class="sd">        import time</span>
<span class="sd">        from spheropy.Sphero import Sphero</span>
<span class="sd">        def callback(data):</span>
<span class="sd">            #data will be a CollisionMsg</span>
<span class="sd">            print(data.x)</span>
<span class="sd">            print(data.y)</span>
<span class="sd">            print(data.axis)</span>
<span class="sd">            print(data.speed)</span>
<span class="sd">            print(data.timestamp)</span>
<span class="sd">        with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">            s.register_collision_callback(callback)</span>
<span class="sd">            s.start_collision_detection(100, 50, 100, 50)</span>
<span class="sd">            time.sleep(10)</span>
<span class="sd">            s.stop_collision_detection()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_collision_callback</span> <span class="o">=</span> <span class="n">func</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.register_power_callback">
    <p>def <span class="ident">register_power_callback</span>(</p><p>self, func)</p>
    </div>
    

    
  
    <div class="desc"><p>Register a function to call when an async power notification is recieved. <code>func</code> must be callable and it will be started in it's own thread. The call back will recieve an integer with:</p>
<p>1 = charging</p>
<p>2 = OK</p>
<p>3 = Low</p>
<p>4 = Critical </p>
<h3>Usage:</h3>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">sphropy.Sphero</span> <span class="kn">import</span> <span class="n">Sphero</span>

<span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">notification</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">notification</span><span class="p">)</span>

<span class="k">with</span> <span class="n">Sphero</span><span class="p">(</span><span class="s2">&quot;Sphero-YWY&quot;</span><span class="p">,</span> <span class="s2">&quot;68:86:E7:07:59:71&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">s</span><span class="o">.</span><span class="n">register_power_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">set_power_notification</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.register_power_callback', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.register_power_callback" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_power_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a function to call when an async power notification is recieved. `func` must be callable and it will be started in it&#39;s own thread. The call back will recieve an integer with:</span>
<span class="sd">    1 = charging</span>
<span class="sd">    2 = OK</span>
<span class="sd">    3 = Low</span>
<span class="sd">    4 = Critical </span>
<span class="sd">    ### Usage:</span>
<span class="sd">        #!python</span>
<span class="sd">        import time</span>
<span class="sd">        from sphropy.Sphero import Sphero</span>
<span class="sd">        def callback(notification):</span>
<span class="sd">            print(notification)</span>
<span class="sd">        with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">            s.register_power_callback(callback)</span>
<span class="sd">            s.set_power_notification(True)</span>
<span class="sd">            time.sleep(20)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_power_callback</span> <span class="o">=</span> <span class="n">func</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.register_sensor_callback">
    <p>def <span class="ident">register_sensor_callback</span>(</p><p>self, func)</p>
    </div>
    

    
  
    <div class="desc"><p>Register a function to call when a sensor message is recieved.
<code>func</code> must be callable and it will be started in its own thread
as not to block the recieve loop.</p>
<h3>Usage:</h3>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">spheropy.Sphero</span> <span class="kn">import</span> <span class="n">Sphero</span>

<span class="n">dsm</span> <span class="o">=</span> <span class="n">DataStreamManager</span><span class="p">()</span>
<span class="n">dsm</span><span class="o">.</span><span class="n">acc</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">dsm</span><span class="o">.</span><span class="n">odom</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1">#assume acc and odom sensor messages have be requested</span>
<span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">sensor_data</span><span class="p">):</span>
    <span class="c1">#sensor_data will be an array of dictionaries where</span>
    <span class="c1">#each item is a frame sent by the sphero</span>
    <span class="k">for</span>  <span class="n">frames</span> <span class="ow">in</span> <span class="n">sensor_data</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">frames</span><span class="p">[</span><span class="s1">&#39;acc&#39;</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="n">frames</span><span class="p">[</span><span class="s1">&#39;odom&#39;</span><span class="p">])</span>

<span class="k">with</span> <span class="n">Sphero</span><span class="p">(</span><span class="s2">&quot;Sphero-YWY&quot;</span><span class="p">,</span> <span class="s2">&quot;68:86:E7:07:59:71&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">s</span><span class="o">.</span><span class="n">register_sensor_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">set_data_stream</span><span class="p">(</span><span class="n">dsm</span><span class="p">,</span> <span class="mi">10</span> <span class="n">packet_count</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># callback will be called twice</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># so data will be recieved before exit</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.register_sensor_callback', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.register_sensor_callback" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">register_sensor_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register a function to call when a sensor message is recieved.</span>
<span class="sd">    `func` must be callable and it will be started in its own thread</span>
<span class="sd">    as not to block the recieve loop.</span>
<span class="sd">    ### Usage:</span>
<span class="sd">        #!python</span>
<span class="sd">        from time import sleep</span>
<span class="sd">        from spheropy.Sphero import Sphero</span>
<span class="sd">        dsm = DataStreamManager()</span>
<span class="sd">        dsm.acc = True</span>
<span class="sd">        dsm.odom = True</span>
<span class="sd">        #assume acc and odom sensor messages have be requested</span>
<span class="sd">        def callback(sensor_data):</span>
<span class="sd">            #sensor_data will be an array of dictionaries where</span>
<span class="sd">            #each item is a frame sent by the sphero</span>
<span class="sd">            for  frames in sensor_data:</span>
<span class="sd">                print(frames[&#39;acc&#39;])</span>
<span class="sd">                print(frames[&#39;odom&#39;])</span>
<span class="sd">        with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">            s.register_sensor_callback(callback)</span>
<span class="sd">            s.set_data_stream(dsm, 10 packet_count=2)</span>
<span class="sd">            # callback will be called twice</span>
<span class="sd">            sleep(1) # so data will be recieved before exit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sensor_callback</span> <span class="o">=</span> <span class="n">func</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.roll">
    <p>def <span class="ident">roll</span>(</p><p>self, speed, heading, fast_rotate=False, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Commands the sphero to move. <code>speed</code> ranges from 0..255, while <code>heading</code> is
in degrees from 0..359, 0 is strait, 90 is to the right, 180 is back and
270 is to the left. When <code>fast_rotate</code> is set to True sphero will rotate as
quickly as possible to given heading regardless of speed.</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.roll', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.roll" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">heading</span><span class="p">,</span> <span class="n">fast_rotate</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Commands the sphero to move. `speed` ranges from 0..255, while `heading` is</span>
<span class="sd">    in degrees from 0..359, 0 is strait, 90 is to the right, 180 is back and</span>
<span class="sd">    270 is to the left. When `fast_rotate` is set to True sphero will rotate as</span>
<span class="sd">    quickly as possible to given heading regardless of speed.</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gobit</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x02</span><span class="p">]</span> <span class="k">if</span> <span class="n">fast_rotate</span> <span class="k">else</span> <span class="p">[</span><span class="mh">0x01</span><span class="p">]</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">heading</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">heading</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;ROLL&#39;</span><span class="p">],</span> <span class="n">speed</span> <span class="o">+</span> <span class="n">heading</span> <span class="o">+</span> <span class="n">gobit</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_back_light">
    <p>def <span class="ident">set_back_light</span>(</p><p>self, brightness, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Controls the brightness of the back LED, non persistent</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_back_light', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_back_light" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_back_light</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brightness</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controls the brightness of the back LED, non persistent</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">brightness</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">brightness</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET BACKLIGHT&#39;</span><span class="p">],</span> <span class="n">brightness</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_color">
    <p>def <span class="ident">set_color</span>(</p><p>self, red, green, blue, default=False, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Sets the color of the sphero given rgb components between 0 and 255,
if <code>default</code> is true, sphero will default to that color when first connected</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p>
<h3>Usage:</h3>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">spheropy.Sphero</span> <span class="kn">import</span> <span class="n">Sphero</span>

<span class="k">with</span> <span class="n">Sphero</span><span class="p">(</span><span class="s2">&quot;Sphero-YWY&quot;</span><span class="p">,</span> <span class="s2">&quot;68:86:E7:07:59:71&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">s</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_color', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_color" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the color of the sphero given rgb components between 0 and 255,</span>
<span class="sd">    if `default` is true, sphero will default to that color when first connected</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    ### Usage:</span>
<span class="sd">        #!python</span>
<span class="sd">        from time import sleep</span>
<span class="sd">        from spheropy.Sphero import Sphero</span>
<span class="sd">        with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">            s.set_color(255, 0, 0)</span>
<span class="sd">            sleep(1)</span>
<span class="sd">            s.set_color(0, 255, 0)</span>
<span class="sd">            sleep(1)</span>
<span class="sd">            s.set_color(0, 0, 255)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">red</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">red</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">blue</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">blue</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">green</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">green</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x01</span><span class="p">]</span> <span class="k">if</span> <span class="n">default</span> <span class="k">else</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET COLOR&#39;</span><span class="p">],</span> <span class="n">red</span> <span class="o">+</span> <span class="n">green</span> <span class="o">+</span> <span class="n">blue</span> <span class="o">+</span> <span class="n">flag</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_data_stream">
    <p>def <span class="ident">set_data_stream</span>(</p><p>self, stream_settings, frequency, packet_count=0, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Sets data stream options, where <code>stream_settings</code> is a DataStreamManager object,
and <code>frequency</code> how often you want to recieve data and <code>packet_count</code> indicates
the number of packets you want to recieve, set to zero for unlimited streaming.</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p>
<h3>Usage:</h3>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">spheropy.Sphero</span> <span class="kn">import</span> <span class="n">Sphero</span>
<span class="kn">from</span> <span class="nn">spheropy.DataStream</span> <span class="kn">import</span> <span class="n">DataStreamManager</span>

<span class="n">dsm</span> <span class="o">=</span> <span class="n">DataStreamManager</span><span class="p">()</span>
<span class="n">dsm</span><span class="o">.</span><span class="n">acc</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">with</span> <span class="n">Sphero</span><span class="p">(</span><span class="s2">&quot;Sphero-YWY&quot;</span><span class="p">,</span> <span class="s2">&quot;68:86:E7:07:59:71&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">s</span><span class="o">.</span><span class="n">set_data_stream</span><span class="p">(</span><span class="n">dsm</span><span class="p">,</span> <span class="mi">10</span> <span class="n">packet_count</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_data_stream', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_data_stream" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_data_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream_settings</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">packet_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets data stream options, where `stream_settings` is a DataStreamManager object,</span>
<span class="sd">    and `frequency` how often you want to recieve data and `packet_count` indicates</span>
<span class="sd">    the number of packets you want to recieve, set to zero for unlimited streaming.</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    ### Usage:</span>
<span class="sd">        #!python</span>
<span class="sd">        from spheropy.Sphero import Sphero</span>
<span class="sd">        from spheropy.DataStream import DataStreamManager</span>
<span class="sd">        dsm = DataStreamManager()</span>
<span class="sd">        dsm.acc = True</span>
<span class="sd">        with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">            s.set_data_stream(dsm, 10 packet_count=2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span> <span class="o">=</span> <span class="n">stream_settings</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">divisor</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">400.0</span> <span class="o">/</span> <span class="n">frequency</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span><span class="o">.</span><span class="n">number_frames</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">mask1</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span><span class="o">.</span><span class="n">mask1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">mask2</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span><span class="o">.</span><span class="n">mask2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">divisor</span> <span class="o">+</span> <span class="n">samples</span> <span class="o">+</span> <span class="n">mask1</span> <span class="o">+</span> <span class="p">[</span><span class="n">packet_count</span><span class="p">]</span> <span class="o">+</span> <span class="n">mask2</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET DATA STRM&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_device_name">
    <p>def <span class="ident">set_device_name</span>(</p><p>self, name, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>This assigned name is held internally and produced as part of the Get Bluetooth Info
service below. Names are clipped at 48 characters in length to support UTF - 8 sequences
you can send something longer but the extra will be discarded.
This field defaults to the Bluetooth advertising name.</p>
<p>The returned Response objects data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_device_name', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_device_name" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_device_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This assigned name is held internally and produced as part of the Get Bluetooth Info</span>
<span class="sd">    service below. Names are clipped at 48 characters in length to support UTF - 8 sequences</span>
<span class="sd">    you can send something longer but the extra will be discarded.</span>
<span class="sd">    This field defaults to the Bluetooth advertising name.</span>
<span class="sd">    The returned Response objects data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET NAME&#39;</span><span class="p">],</span> <span class="n">name</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_heading">
    <p>def <span class="ident">set_heading</span>(</p><p>self, heading, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Sets the spheros heading in degrees,
heading must range between 0 to 359. This should move the
back tail light.</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_heading', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_heading" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_heading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">heading</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the spheros heading in degrees,</span>
<span class="sd">    heading must range between 0 to 359. This should move the</span>
<span class="sd">    back tail light.</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">heading</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">heading</span> <span class="o">&gt;</span> <span class="mi">359</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;heading must be between 0 and 359&quot;</span><span class="p">)</span>
    <span class="n">heading_bytes</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">heading</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET HEADING&#39;</span><span class="p">],</span> <span class="n">heading_bytes</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">reply</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_inactivity_timeout">
    <p>def <span class="ident">set_inactivity_timeout</span>(</p><p>self, timeout, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Sets inactivity time out. Value must be greater than 60 seconds,
 is preserved across power cycles.</p>
<p>The returned Response object's data field will be empty,
 but if <code>response</code> is set to <code>True</code>, it's success field
 will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_inactivity_timeout', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_inactivity_timeout" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_inactivity_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets inactivity time out. Value must be greater than 60 seconds,</span>
<span class="sd">    is preserved across power cycles.</span>
<span class="sd">   The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">timeout</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">timeout</span> <span class="o">&gt;</span> <span class="mh">0xffff</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="n">big</span> <span class="o">=</span> <span class="n">timeout</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
    <span class="n">little</span> <span class="o">=</span> <span class="p">(</span><span class="n">timeout</span> <span class="o">&amp;</span> <span class="mh">0x00ff</span><span class="p">)</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET INACT TIMEOUT&#39;</span><span class="p">],</span> <span class="p">[</span>
        <span class="n">big</span><span class="p">,</span> <span class="n">little</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">reply</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_motion_timeout">
    <p>def <span class="ident">set_motion_timeout</span>(</p><p>self, timeout, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>This sets the ultimate timeout for the last motion command
to keep Sphero from rolling away
timeout is in miliseconds and defaults to 2000
for this to be in effect motion timeout must be
in must be set in permanent options</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_motion_timeout', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_motion_timeout" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_motion_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This sets the ultimate timeout for the last motion command</span>
<span class="sd">    to keep Sphero from rolling away</span>
<span class="sd">    timeout is in miliseconds and defaults to 2000</span>
<span class="sd">    for this to be in effect motion timeout must be</span>
<span class="sd">    in must be set in permanent options</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outside_range</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xFFFF</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">SpheroException</span><span class="p">(</span><span class="s2">&quot;Timeout outside of valid range&quot;</span><span class="p">)</span>
    <span class="n">timeout</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;MOTION TIMEOUT&#39;</span><span class="p">],</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_permanent_options">
    <p>def <span class="ident">set_permanent_options</span>(</p><p>self, options, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Set Options, for option information see PermanentOptionFlag docs.
Options persist across power cycles. <code>options</code> is a Permanent Option Object</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p>
<h3>Usage:</h3>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">spheropy.Sphero</span> <span class="kn">import</span> <span class="n">Sphero</span>
<span class="kn">from</span> <span class="nn">spheropy.Options</span> <span class="kn">import</span> <span class="n">PermanentOptions</span>

<span class="n">po</span> <span class="o">=</span> <span class="n">PermanentOptions</span><span class="p">()</span>
<span class="n">po</span><span class="o">.</span><span class="n">set_light_wakeup_sensitivity</span><span class="o">=</span> <span class="bp">True</span>
<span class="k">with</span> <span class="n">Sphero</span><span class="p">(</span><span class="s2">&quot;Sphero-YWY&quot;</span><span class="p">,</span> <span class="s2">&quot;68:86:E7:07:59:71&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">s</span><span class="o">.</span><span class="n">set_permanent_options</span><span class="p">(</span><span class="n">po</span><span class="p">)</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_permanent_options', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_permanent_options" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_permanent_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set Options, for option information see PermanentOptionFlag docs.</span>
<span class="sd">    Options persist across power cycles. `options` is a Permanent Option Object</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    ### Usage:</span>
<span class="sd">        #!python</span>
<span class="sd">        from spheropy.Sphero import Sphero</span>
<span class="sd">        from spheropy.Options import PermanentOptions</span>
<span class="sd">        po = PermanentOptions()</span>
<span class="sd">        po.set_light_wakeup_sensitivity= True</span>
<span class="sd">        with Sphero(&quot;Sphero-YWY&quot;, &quot;68:86:E7:07:59:71&quot;) as s:</span>
<span class="sd">            s.set_permanent_options(po)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">bitflags</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET PERM OPTIONS&#39;</span><span class="p">],</span> <span class="n">options</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_power_notification">
    <p>def <span class="ident">set_power_notification</span>(</p><p>self, setting, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Sets Async power notification messages to be sent. To access the notifications register a power_notfiation callback. Notifications
are sent every 10 seconds</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_power_notification', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_power_notification" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_power_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setting</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets Async power notification messages to be sent. To access the notifications register a power_notfiation callback. Notifications</span>
<span class="sd">    are sent every 10 seconds</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="k">if</span> <span class="n">setting</span> <span class="k">else</span> <span class="mh">0x00</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET POWER NOTIFICATION&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">flag</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">reply</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_raw_motor_values">
    <p>def <span class="ident">set_raw_motor_values</span>(</p><p>self, left_value, right_value, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Allows direct controle of the motors
both motor values should be MotorValue tuple</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_raw_motor_values', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_raw_motor_values" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_raw_motor_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_value</span><span class="p">,</span> <span class="n">right_value</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allows direct controle of the motors</span>
<span class="sd">    both motor values should be MotorValue tuple</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lmode</span> <span class="o">=</span> <span class="n">left_value</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
    <span class="n">lpower</span> <span class="o">=</span> <span class="n">left_value</span><span class="o">.</span><span class="n">power</span>
    <span class="n">rmode</span> <span class="o">=</span> <span class="n">right_value</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
    <span class="n">rpower</span> <span class="o">=</span> <span class="n">right_value</span><span class="o">.</span><span class="n">power</span>
    <span class="k">if</span> <span class="n">outside_range</span><span class="p">(</span><span class="n">lpower</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="ow">or</span> <span class="n">outside_range</span><span class="p">(</span><span class="n">rpower</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">SpheroException</span><span class="p">(</span><span class="s2">&quot;Values outside of range&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">lmode</span><span class="p">,</span> <span class="n">lpower</span><span class="p">,</span> <span class="n">rmode</span><span class="p">,</span> <span class="n">rpower</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET RAW MOTOR&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_rotation_rate">
    <p>def <span class="ident">set_rotation_rate</span>(</p><p>self, rate, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>DOESN't WORK
This sets the roation rate sphero will use to meet new heading commands
Lower value offers better control, with a larger turning radius.
The rate should be in degrees / sec,
anythin above 199 the maxium value is used(400 degrees / sec)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_rotation_rate', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_rotation_rate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_rotation_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DOESN&#39;t WORK</span>
<span class="sd">    This sets the roation rate sphero will use to meet new heading commands</span>
<span class="sd">    Lower value offers better control, with a larger turning radius.</span>
<span class="sd">    The rate should be in degrees / sec,</span>
<span class="sd">    anythin above 199 the maxium value is used(400 degrees / sec)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO returns unknown command</span>
    <span class="k">if</span> <span class="n">rate</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;USE POSITIVE RATE ONLY&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rate</span> <span class="o">&gt;</span> <span class="mi">199</span><span class="p">:</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="mi">200</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rate</span> <span class="o">/</span> <span class="mf">0.784</span><span class="p">)</span>
    <span class="n">to_bytes</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET ROTATION RATE&#39;</span><span class="p">],</span> <span class="n">to_bytes</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_stabilization">
    <p>def <span class="ident">set_stabilization</span>(</p><p>self, stablize, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>This turns on or off the internal stabilization of Sphero,
the IMU is used to match the ball's orientation to its set points.</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_stabilization', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_stabilization" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_stabilization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stablize</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This turns on or off the internal stabilization of Sphero,</span>
<span class="sd">    the IMU is used to match the ball&#39;s orientation to its set points.</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="k">if</span> <span class="n">stablize</span> <span class="k">else</span> <span class="mh">0x00</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET STABILIZATION&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">flag</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_stop_on_disconnect">
    <p>def <span class="ident">set_stop_on_disconnect</span>(</p><p>self, value=True, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Sets sphero to stop on disconnect, this is a one_shot, so it must be reset on reconnect.</p>
<p>Set <code>value</code> to false to turn off behavior.</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_stop_on_disconnect', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_stop_on_disconnect" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_stop_on_disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets sphero to stop on disconnect, this is a one_shot, so it must be reset on reconnect.</span>
<span class="sd">    Set `value` to false to turn off behavior.</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET TEMP OPTIONS&#39;</span><span class="p">],</span> <span class="p">[</span>
        <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.set_voltage_trip_points">
    <p>def <span class="ident">set_voltage_trip_points</span>(</p><p>self, low, critical, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>DOES NOT WORK
not implemented
This assigns the voltage trip points for Low and Critical battery voltages.
The values are specified in 100ths of a volt and
the limitations on adjusting these away from their defaults are:
Vlow must be in the range 675 to 725 ( += 25)
Vcrit must be in the range 625 to 675 ( += 25)
There must be 0.25V of separation between the two values</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.set_voltage_trip_points', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.set_voltage_trip_points" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">set_voltage_trip_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">critical</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DOES NOT WORK</span>
<span class="sd">    not implemented</span>
<span class="sd">    This assigns the voltage trip points for Low and Critical battery voltages.</span>
<span class="sd">    The values are specified in 100ths of a volt and</span>
<span class="sd">    the limitations on adjusting these away from their defaults are:</span>
<span class="sd">    Vlow must be in the range 675 to 725 ( += 25)</span>
<span class="sd">    Vcrit must be in the range 625 to 675 ( += 25)</span>
<span class="sd">    There must be 0.25V of separation between the two values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="bp">False</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">crit</span> <span class="o">=</span> <span class="n">int_to_bytes</span><span class="p">(</span><span class="n">critical</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET VOLTAGE TRIP&#39;</span><span class="p">],</span> <span class="n">low</span> <span class="o">+</span> <span class="n">crit</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.sleep">
    <p>def <span class="ident">sleep</span>(</p><p>self, wakeup_time, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>This command puts Sphero to sleep immediately.
The sphero will automaticall reawaken after <code>wakeup_time</code> seconds.
Zero does not program a wakeup interval, so it sleeps forever.</p>
<p>The Sphero must be reconnected after this function is called. However,
most settings are preserved.</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.sleep', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.sleep" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sleep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wakeup_time</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This command puts Sphero to sleep immediately.</span>
<span class="sd">    The sphero will automaticall reawaken after `wakeup_time` seconds.</span>
<span class="sd">    Zero does not program a wakeup interval, so it sleeps forever.</span>
<span class="sd">    The Sphero must be reconnected after this function is called. However,</span>
<span class="sd">    most settings are preserved.</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">wakeup_time</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">wakeup_time</span> <span class="o">&gt;</span> <span class="mh">0xffff</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">False</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">big</span> <span class="o">=</span> <span class="n">wakeup_time</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span>
    <span class="n">little</span> <span class="o">=</span> <span class="p">(</span><span class="n">wakeup_time</span> <span class="o">&amp;</span> <span class="mh">0x00ff</span><span class="p">)</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_CORE</span><span class="p">,</span> <span class="n">_CORE_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SLEEP&#39;</span><span class="p">],</span> <span class="p">[</span>
        <span class="n">big</span><span class="p">,</span> <span class="n">little</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">reply</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.start">
    <p>def <span class="ident">start</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.start', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.start" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_recieve_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.start_collision_detection">
    <p>def <span class="ident">start_collision_detection</span>(</p><p>self, x_threshold, x_speed, y_threshold, y_speed, dead=1000, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Starts collision detection. <code>Threshold</code> values represent the max threshold,
and <code>speed</code> is added to the thresholds to rang detection by the spheros speed,
<code>dead</code> is the minimum time between detections
in ms. all data must be in the range 0...255</p>
<p>For more infomation see Collision Detection pdf</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.start_collision_detection', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.start_collision_detection" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">start_collision_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_threshold</span><span class="p">,</span> <span class="n">x_speed</span><span class="p">,</span> <span class="n">y_threshold</span><span class="p">,</span> <span class="n">y_speed</span><span class="p">,</span> <span class="n">dead</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Starts collision detection. `Threshold` values represent the max threshold,</span>
<span class="sd">    and `speed` is added to the thresholds to rang detection by the spheros speed,</span>
<span class="sd">    `dead` is the minimum time between detections</span>
<span class="sd">    in ms. all data must be in the range 0...255</span>
<span class="sd">    For more infomation see Collision Detection pdf</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">method</span> <span class="o">=</span> <span class="mh">0x01</span>
    <span class="n">dead</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dead</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET COLLISION DETECT&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">method</span><span class="p">,</span> <span class="n">x_threshold</span><span class="p">,</span> <span class="n">x_speed</span><span class="p">,</span> <span class="n">y_threshold</span><span class="p">,</span> <span class="n">y_speed</span><span class="p">,</span> <span class="n">dead</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.stop">
    <p>def <span class="ident">stop</span>(</p><p>self, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Commands the Shero to stop.</p>
<p>The returned Response object's data field will be empty,
but if <code>response</code> is set to <code>True</code>, it's success field
will indicate if the command was successful.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.stop', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.stop" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Commands the Shero to stop.</span>
<span class="sd">    The returned Response object&#39;s data field will be empty,</span>
<span class="sd">    but if `response` is set to `True`, it&#39;s success field</span>
<span class="sd">    will indicate if the command was successful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;ROLL&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.stop_collision_detection">
    <p>def <span class="ident">stop_collision_detection</span>(</p><p>self, response=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Stops collision detection</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.stop_collision_detection', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.stop_collision_detection" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">stop_collision_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stops collision detection</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET COLLISION DETECT&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.stop_data_stream">
    <p>def <span class="ident">stop_data_stream</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>stops data streaming</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.stop_data_stream', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.stop_data_stream" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">stop_data_stream</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    stops data streaming</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span><span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;SET DATA STRM&#39;</span><span class="p">],</span> <span class="p">[</span>
                               <span class="mh">0xff</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_stream</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="spheropy.Sphero.Sphero.will_stop_on_disconnect">
    <p>def <span class="ident">will_stop_on_disconnect</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns if the sphero will stop when it is disconnected.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-spheropy.Sphero.Sphero.will_stop_on_disconnect', this);">Show source &equiv;</a></p>
  <div id="source-spheropy.Sphero.Sphero.will_stop_on_disconnect" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">will_stop_on_disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns if the sphero will stop when it is disconnected.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stable_send</span><span class="p">(</span>
        <span class="n">_SPHERO</span><span class="p">,</span> <span class="n">_SPHERO_COMMANDS</span><span class="p">[</span><span class="s1">&#39;GET TEMP OPTOINS&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="nb">bool</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
